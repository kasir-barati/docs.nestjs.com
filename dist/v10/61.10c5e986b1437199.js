"use strict";(self.webpackChunkdocs_nestjs_com=self.webpackChunkdocs_nestjs_com||[]).push([[61],{7061:(v,p,a)=>{a.r(p),a.d(p,{OpenApiModule:()=>C});var c=a(177),F=a(2647),d=a(3887),r=a(8050),e=a(4438),i=a(4819);let l=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-cli-plugin"]],features:[e.Vt3],decls:440,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/cli-plugin.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","cli-plugin"],["rel","nofollow","target","_blank","href","https://www.typescriptlang.org/docs/handbook/decorators.html"],[1,"info"],["appAnchor","","id","overview"],[1,"language-typescript"],["href","/openapi/cli-plugin#using-the-cli-plugin"],["rel","nofollow","target","_blank","href","https://docs.nestjs.com/openapi/mapped-types"],["appAnchor","","id","comments-introspection"],[1,"language-ts"],["appAnchor","","id","using-the-cli-plugin"],["routerLink","/cli/overview"],[1,"language-javascript"],["appAnchor","","id","swc-builder"],["href","/recipes/swc#type-checking"],[1,"language-bash"],["href","/recipes/swc#monorepo-and-cli-plugins"],["appAnchor","","id","integration-with-ts-jest-e2e-tests"],[1,"language-json"],["appAnchor","","id","troubleshooting-jest-e2e-tests"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"CLI Plugin"),e.k0s(),e.j41(7,"p")(8,"a",6),e.EFF(9,"TypeScript"),e.k0s(),e.EFF(10,"'s metadata reflection system has several limitations which make it impossible to, for instance, determine what properties a class consists of or recognize whether a given property is optional or required. However, some of these constraints can be addressed at compilation time. Nest provides a plugin that enhances the TypeScript compilation process to reduce the amount of boilerplate code required."),e.k0s(),e.j41(11,"blockquote",7)(12,"strong"),e.EFF(13,"Hint"),e.k0s(),e.EFF(14," This plugin is "),e.j41(15,"strong"),e.EFF(16,"opt-in"),e.k0s(),e.EFF(17,". If you prefer, you can declare all decorators manually, or only specific decorators where you need them.\n"),e.k0s(),e.j41(18,"h4",8)(19,"span"),e.EFF(20,"Overview"),e.k0s()(),e.j41(21,"p"),e.EFF(22,"The Swagger plugin will automatically:"),e.k0s(),e.j41(23,"ul")(24,"li"),e.EFF(25,"annotate all DTO properties with "),e.j41(26,"code"),e.EFF(27,"@ApiProperty"),e.k0s(),e.EFF(28," unless "),e.j41(29,"code"),e.EFF(30,"@ApiHideProperty"),e.k0s(),e.EFF(31," is used"),e.k0s(),e.j41(32,"li"),e.EFF(33,"set the "),e.j41(34,"code"),e.EFF(35,"required"),e.k0s(),e.EFF(36," property depending on the question mark (e.g. "),e.j41(37,"code"),e.EFF(38,"name?: string"),e.k0s(),e.EFF(39," will set "),e.j41(40,"code"),e.EFF(41,"required: false"),e.k0s(),e.EFF(42,")"),e.k0s(),e.j41(43,"li"),e.EFF(44,"set the "),e.j41(45,"code"),e.EFF(46,"type"),e.k0s(),e.EFF(47," or "),e.j41(48,"code"),e.EFF(49,"enum"),e.k0s(),e.EFF(50," property depending on the type (supports arrays as well)"),e.k0s(),e.j41(51,"li"),e.EFF(52,"set the "),e.j41(53,"code"),e.EFF(54,"default"),e.k0s(),e.EFF(55," property based on the assigned default value"),e.k0s(),e.j41(56,"li"),e.EFF(57,"set several validation rules based on "),e.j41(58,"code"),e.EFF(59,"class-validator"),e.k0s(),e.EFF(60," decorators (if "),e.j41(61,"code"),e.EFF(62,"classValidatorShim"),e.k0s(),e.EFF(63," set to "),e.j41(64,"code"),e.EFF(65,"true"),e.k0s(),e.EFF(66,")"),e.k0s(),e.j41(67,"li"),e.EFF(68,"add a response decorator to every endpoint with a proper status and "),e.j41(69,"code"),e.EFF(70,"type"),e.k0s(),e.EFF(71," (response model)"),e.k0s(),e.j41(72,"li"),e.EFF(73,"generate descriptions for properties and endpoints based on comments (if "),e.j41(74,"code"),e.EFF(75,"introspectComments"),e.k0s(),e.EFF(76," set to "),e.j41(77,"code"),e.EFF(78,"true"),e.k0s(),e.EFF(79,")"),e.k0s(),e.j41(80,"li"),e.EFF(81,"generate example values for properties based on comments (if "),e.j41(82,"code"),e.EFF(83,"introspectComments"),e.k0s(),e.EFF(84," set to "),e.j41(85,"code"),e.EFF(86,"true"),e.k0s(),e.EFF(87,")"),e.k0s()(),e.j41(88,"p"),e.EFF(89,"Please, note that your filenames "),e.j41(90,"strong"),e.EFF(91,"must have"),e.k0s(),e.EFF(92," one of the following suffixes: "),e.j41(93,"code"),e.EFF(94,"['.dto.ts', '.entity.ts']"),e.k0s(),e.EFF(95," (e.g., "),e.j41(96,"code"),e.EFF(97,"create-user.dto.ts"),e.k0s(),e.EFF(98,") in order to be analysed by the plugin."),e.k0s(),e.j41(99,"p"),e.EFF(100,"If you are using a different suffix, you can adjust the plugin's behavior by specifying the "),e.j41(101,"code"),e.EFF(102,"dtoFileNameSuffix"),e.k0s(),e.EFF(103," option (see below)."),e.k0s(),e.j41(104,"p"),e.EFF(105,"Previously, if you wanted to provide an interactive experience with the Swagger UI,\nyou had to duplicate a lot of code to let the package know how your models/components should be declared in the specification. For example, you could define a simple "),e.j41(106,"code"),e.EFF(107,"CreateUserDto"),e.k0s(),e.EFF(108," class as follows:"),e.k0s(),e.j41(109,"pre")(110,"code",9),e.EFF(111,"\nexport class CreateUserDto {\n  @ApiProperty()\n  email: string;\n\n  @ApiProperty()\n  password: string;\n\n  @ApiProperty({ enum: RoleEnum, default: [], isArray: true })\n  roles: RoleEnum[] = [];\n\n  @ApiProperty({ required: false, default: true })\n  isEnabled?: boolean = true;\n}\n"),e.k0s()(),e.j41(112,"p"),e.EFF(113,"While not a significant issue with medium-sized projects, it becomes verbose & hard to maintain once you have a large set of classes."),e.k0s(),e.j41(114,"p"),e.EFF(115,"By "),e.j41(116,"a",10),e.EFF(117,"enabling the Swagger plugin"),e.k0s(),e.EFF(118,", the above class definition can be declared simply:"),e.k0s(),e.j41(119,"pre")(120,"code",9),e.EFF(121,"\nexport class CreateUserDto {\n  email: string;\n  password: string;\n  roles: RoleEnum[] = [];\n  isEnabled?: boolean = true;\n}\n"),e.k0s()(),e.j41(122,"blockquote",7)(123,"strong"),e.EFF(124,"Note"),e.k0s(),e.EFF(125," The Swagger plugin will derive the @ApiProperty() annotations from the TypeScript types and class-validator decorators. This helps in clearly describing your API for the generated Swagger UI documentation. However, the validation at runtime would still be handled by class-validator decorators. So, it is required to continue using validators like "),e.j41(126,"code"),e.EFF(127,"IsEmail()"),e.k0s(),e.EFF(128,", "),e.j41(129,"code"),e.EFF(130,"IsNumber()"),e.k0s(),e.EFF(131,", etc.\n"),e.k0s(),e.j41(132,"p"),e.EFF(133,"Hence, if you intend to rely on automatic annotations for generating documentations and still wish for runtime validations, then the class-validator decorators are still necessary."),e.k0s(),e.j41(134,"blockquote",7)(135,"strong"),e.EFF(136,"Hint"),e.k0s(),e.EFF(137," When using "),e.j41(138,"a",11),e.EFF(139,"mapped types utilities"),e.k0s(),e.EFF(140," (like "),e.j41(141,"code"),e.EFF(142,"PartialType"),e.k0s(),e.EFF(143,") in DTOs import them from "),e.j41(144,"code"),e.EFF(145,"@nestjs/swagger"),e.k0s(),e.EFF(146," instead of "),e.j41(147,"code"),e.EFF(148,"@nestjs/mapped-types"),e.k0s(),e.EFF(149," for the plugin to pick up the schema.\n"),e.k0s(),e.j41(150,"p"),e.EFF(151,"The plugin adds appropriate decorators on the fly based on the "),e.j41(152,"strong"),e.EFF(153,"Abstract Syntax Tree"),e.k0s(),e.EFF(154,". Thus you won't have to struggle with "),e.j41(155,"code"),e.EFF(156,"@ApiProperty"),e.k0s(),e.EFF(157," decorators scattered throughout the code."),e.k0s(),e.j41(158,"blockquote",7)(159,"strong"),e.EFF(160,"Hint"),e.k0s(),e.EFF(161," The plugin will automatically generate any missing swagger properties, but if you need to override them, you simply set them explicitly via "),e.j41(162,"code"),e.EFF(163,"@ApiProperty()"),e.k0s(),e.EFF(164,".\n"),e.k0s(),e.j41(165,"h4",12)(166,"span"),e.EFF(167,"Comments introspection"),e.k0s()(),e.j41(168,"p"),e.EFF(169,"With the comments introspection feature enabled, CLI plugin will generate descriptions and example values for properties based on comments."),e.k0s(),e.j41(170,"p"),e.EFF(171,"For example, given an example "),e.j41(172,"code"),e.EFF(173,"roles"),e.k0s(),e.EFF(174," property:"),e.k0s(),e.j41(175,"pre")(176,"code",9),e.EFF(177,"\n/**\n * A list of user's roles\n * @example ['admin']\n */\n@ApiProperty({\n  description: `A list of user's roles`,\n  example: ['admin'],\n})\nroles: RoleEnum[] = [];\n"),e.k0s()(),e.j41(178,"p"),e.EFF(179,"You must duplicate both description and example values. With "),e.j41(180,"code"),e.EFF(181,"introspectComments"),e.k0s(),e.EFF(182," enabled, the CLI plugin can extract these comments and automatically provide descriptions (and examples, if defined) for properties. Now, the above property can be declared simply as follows:"),e.k0s(),e.j41(183,"pre")(184,"code",9),e.EFF(185,"\n/**\n * A list of user's roles\n * @example ['admin']\n */\nroles: RoleEnum[] = [];\n"),e.k0s()(),e.j41(186,"p"),e.EFF(187,"There are "),e.j41(188,"code"),e.EFF(189,"dtoKeyOfComment"),e.k0s(),e.EFF(190," and "),e.j41(191,"code"),e.EFF(192,"controllerKeyOfComment"),e.k0s(),e.EFF(193," plugin options that you can use to customize how the plugin will set the value for "),e.j41(194,"code"),e.EFF(195,"ApiProperty"),e.k0s(),e.EFF(196," and "),e.j41(197,"code"),e.EFF(198,"ApiOperation"),e.k0s(),e.EFF(199," decorators respectively. Take a look at the following example:"),e.k0s(),e.j41(200,"pre")(201,"code",9),e.EFF(202,"\nexport class SomeController {\n  /**\n   * Create some resource\n   */\n  @Post()\n  create() {}\n}\n"),e.k0s()(),e.j41(203,"p"),e.EFF(204,"By default, these options are set to "),e.j41(205,"code"),e.EFF(206,'"description"'),e.k0s(),e.EFF(207,". This means the plugin will assign "),e.j41(208,"code"),e.EFF(209,'"Create some resource"'),e.k0s(),e.EFF(210," to "),e.j41(211,"code"),e.EFF(212,"description"),e.k0s(),e.EFF(213," key on the "),e.j41(214,"code"),e.EFF(215,"ApiOperation"),e.k0s(),e.EFF(216," operator. Like so:"),e.k0s(),e.j41(217,"pre")(218,"code",13),e.EFF(219,'\n@ApiOperation({ description: "Create some resource" })\n'),e.k0s()(),e.j41(220,"blockquote",7)(221,"strong"),e.EFF(222,"Hint"),e.k0s(),e.EFF(223," For models, the same logic applies but to "),e.j41(224,"code"),e.EFF(225,"ApiProperty"),e.k0s(),e.EFF(226," decorator instead.\n"),e.k0s(),e.j41(227,"h4",14)(228,"span"),e.EFF(229,"Using the CLI plugin"),e.k0s()(),e.j41(230,"p"),e.EFF(231,"To enable the plugin, open "),e.j41(232,"code"),e.EFF(233,"nest-cli.json"),e.k0s(),e.EFF(234," (if you use "),e.j41(235,"a",15),e.EFF(236,"Nest CLI"),e.k0s(),e.EFF(237,") and add the following "),e.j41(238,"code"),e.EFF(239,"plugins"),e.k0s(),e.EFF(240," configuration:"),e.k0s(),e.j41(241,"pre")(242,"code",16),e.EFF(243,'\n{\n  "collection": "@nestjs/schematics",\n  "sourceRoot": "src",\n  "compilerOptions": {\n    "plugins": ["@nestjs/swagger"]\n  }\n}\n'),e.k0s()(),e.j41(244,"p"),e.EFF(245,"You can use the "),e.j41(246,"code"),e.EFF(247,"options"),e.k0s(),e.EFF(248," property to customize the behavior of the plugin."),e.k0s(),e.j41(249,"pre")(250,"code",16),e.EFF(251,'\n"plugins": [\n  {\n    "name": "@nestjs/swagger",\n    "options": {\n      "classValidatorShim": false,\n      "introspectComments": true\n    }\n  }\n]\n'),e.k0s()(),e.j41(252,"p"),e.EFF(253,"The "),e.j41(254,"code"),e.EFF(255,"options"),e.k0s(),e.EFF(256," property has to fulfill the following interface:"),e.k0s(),e.j41(257,"pre")(258,"code",9),e.EFF(259,"\nexport interface PluginOptions {\n  dtoFileNameSuffix?: string[];\n  controllerFileNameSuffix?: string[];\n  classValidatorShim?: boolean;\n  dtoKeyOfComment?: string;\n  controllerKeyOfComment?: string;\n  introspectComments?: boolean;\n}\n"),e.k0s()(),e.j41(260,"table")(261,"tr")(262,"th"),e.EFF(263,"Option"),e.k0s(),e.j41(264,"th"),e.EFF(265,"Default"),e.k0s(),e.j41(266,"th"),e.EFF(267,"Description"),e.k0s()(),e.j41(268,"tr")(269,"td")(270,"code"),e.EFF(271,"dtoFileNameSuffix"),e.k0s()(),e.j41(272,"td")(273,"code"),e.EFF(274,"['.dto.ts', '.entity.ts']"),e.k0s()(),e.j41(275,"td"),e.EFF(276,"DTO (Data Transfer Object) files suffix"),e.k0s()(),e.j41(277,"tr")(278,"td")(279,"code"),e.EFF(280,"controllerFileNameSuffix"),e.k0s()(),e.j41(281,"td")(282,"code"),e.EFF(283,".controller.ts"),e.k0s()(),e.j41(284,"td"),e.EFF(285,"Controller files suffix"),e.k0s()(),e.j41(286,"tr")(287,"td")(288,"code"),e.EFF(289,"classValidatorShim"),e.k0s()(),e.j41(290,"td")(291,"code"),e.EFF(292,"true"),e.k0s()(),e.j41(293,"td"),e.EFF(294,"If set to true, the module will reuse "),e.j41(295,"code"),e.EFF(296,"class-validator"),e.k0s(),e.EFF(297," validation decorators (e.g. "),e.j41(298,"code"),e.EFF(299,"@Max(10)"),e.k0s(),e.EFF(300," will add "),e.j41(301,"code"),e.EFF(302,"max: 10"),e.k0s(),e.EFF(303," to schema definition) "),e.k0s()(),e.j41(304,"tr")(305,"td")(306,"code"),e.EFF(307,"dtoKeyOfComment"),e.k0s()(),e.j41(308,"td")(309,"code"),e.EFF(310,"'description'"),e.k0s()(),e.j41(311,"td"),e.EFF(312,"The property key to set the comment text to on "),e.j41(313,"code"),e.EFF(314,"ApiProperty"),e.k0s(),e.EFF(315,"."),e.k0s()(),e.j41(316,"tr")(317,"td")(318,"code"),e.EFF(319,"controllerKeyOfComment"),e.k0s()(),e.j41(320,"td")(321,"code"),e.EFF(322,"'description'"),e.k0s()(),e.j41(323,"td"),e.EFF(324,"The property key to set the comment text to on "),e.j41(325,"code"),e.EFF(326,"ApiOperation"),e.k0s(),e.EFF(327,"."),e.k0s()(),e.j41(328,"tr")(329,"td")(330,"code"),e.EFF(331,"introspectComments"),e.k0s()(),e.j41(332,"td")(333,"code"),e.EFF(334,"false"),e.k0s()(),e.j41(335,"td"),e.EFF(336,"If set to true, plugin will generate descriptions and example values for properties based on comments"),e.k0s()()(),e.j41(337,"p"),e.EFF(338,"Make sure to delete the "),e.j41(339,"code"),e.EFF(340,"/dist"),e.k0s(),e.EFF(341," folder and rebuild your application whenever plugin options are updated.\nIf you don't use the CLI but instead have a custom "),e.j41(342,"code"),e.EFF(343,"webpack"),e.k0s(),e.EFF(344," configuration, you can use this plugin in combination with "),e.j41(345,"code"),e.EFF(346,"ts-loader"),e.k0s(),e.EFF(347,":"),e.k0s(),e.j41(348,"pre")(349,"code",16),e.EFF(350,"\ngetCustomTransformers: (program: any) => ({\n  before: [require('@nestjs/swagger/plugin').before({}, program)]\n}),\n"),e.k0s()(),e.j41(351,"h4",17)(352,"span"),e.EFF(353,"SWC builder"),e.k0s()(),e.j41(354,"p"),e.EFF(355,"For standard setups (non-monorepo), to use CLI Plugins with the SWC builder, you need to enable type checking, as described "),e.j41(356,"a",18),e.EFF(357,"here"),e.k0s(),e.EFF(358,"."),e.k0s(),e.j41(359,"pre")(360,"code",19),e.EFF(361,"\n$ nest start -b swc --type-check\n"),e.k0s()(),e.j41(362,"p"),e.EFF(363,"For monorepo setups, follow the instructions "),e.j41(364,"a",20),e.EFF(365,"here"),e.k0s(),e.EFF(366,"."),e.k0s(),e.j41(367,"pre")(368,"code",19),e.EFF(369,"\n$ npx ts-node src/generate-metadata.ts\n# OR npx ts-node apps/{YOUR_APP}/src/generate-metadata.ts\n"),e.k0s()(),e.j41(370,"p"),e.EFF(371,"Now, the serialized metadata file must be loaded by the "),e.j41(372,"code"),e.EFF(373,"SwaggerModule#loadPluginMetadata"),e.k0s(),e.EFF(374," method, as shown below:"),e.k0s(),e.j41(375,"pre")(376,"code",9),e.EFF(377,"\nimport metadata from './metadata'; // <-- file auto-generated by the \"PluginMetadataGenerator\"\n\nawait SwaggerModule.loadPluginMetadata(metadata); // <-- here\nconst document = SwaggerModule.createDocument(app, config);\n"),e.k0s()(),e.j41(378,"h4",21)(379,"span"),e.EFF(380,"Integration with "),e.j41(381,"code"),e.EFF(382,"ts-jest"),e.k0s(),e.EFF(383," (e2e tests)"),e.k0s()(),e.j41(384,"p"),e.EFF(385,"To run e2e tests, "),e.j41(386,"code"),e.EFF(387,"ts-jest"),e.k0s(),e.EFF(388," compiles your source code files on the fly, in memory. This means, it doesn't use Nest CLI compiler and does not apply any plugins or perform AST transformations."),e.k0s(),e.j41(389,"p"),e.EFF(390,"To enable the plugin, create the following file in your e2e tests directory:"),e.k0s(),e.j41(391,"pre")(392,"code",16),e.EFF(393,"\nconst transformer = require('@nestjs/swagger/plugin');\n\nmodule.exports.name = 'nestjs-swagger-transformer';\n// you should change the version number anytime you change the configuration below - otherwise, jest will not detect changes\nmodule.exports.version = 1;\n\nmodule.exports.factory = (cs) => {\n  return transformer.before(\n    {\n      // @nestjs/swagger/plugin options (can be empty)\n    },\n    cs.program, // \"cs.tsCompiler.program\" for older versions of Jest (<= v27)\n  );\n};\n"),e.k0s()(),e.j41(394,"p"),e.EFF(395,"With this in place, import AST transformer within your "),e.j41(396,"code"),e.EFF(397,"jest"),e.k0s(),e.EFF(398," configuration file. By default (in the starter application), e2e tests configuration file is located under the "),e.j41(399,"code"),e.EFF(400,"test"),e.k0s(),e.EFF(401," folder and is named "),e.j41(402,"code"),e.EFF(403,"jest-e2e.json"),e.k0s(),e.EFF(404,"."),e.k0s(),e.j41(405,"pre")(406,"code",22),e.EFF(407,'\n{\n  ... // other configuration\n  "globals": {\n    "ts-jest": {\n      "astTransformers": {\n        "before": ["<path to the file created above>"]\n      }\n    }\n  }\n}\n'),e.k0s()(),e.j41(408,"p"),e.EFF(409,"If you use "),e.j41(410,"code"),e.EFF(411,"jest@^29"),e.k0s(),e.EFF(412,", then use the snippet below, as the previous approach got deprecated."),e.k0s(),e.j41(413,"pre")(414,"code",22),e.EFF(415,'\n{\n  ... // other configuration\n  "transform": {\n    "^.+\\\\.(t|j)s$": [\n      "ts-jest",\n      {\n        "astTransformers": {\n          "before": ["<path to the file created above>"]\n        }\n      }\n    ]\n  }\n}\n'),e.k0s()(),e.j41(416,"h4",23)(417,"span"),e.EFF(418,"Troubleshooting "),e.j41(419,"code"),e.EFF(420,"jest"),e.k0s(),e.EFF(421," (e2e tests)"),e.k0s()(),e.j41(422,"p"),e.EFF(423,"In case "),e.j41(424,"code"),e.EFF(425,"jest"),e.k0s(),e.EFF(426," does not seem to pick up your configuration changes, it's possible that Jest has already "),e.j41(427,"strong"),e.EFF(428,"cached"),e.k0s(),e.EFF(429," the build result. To apply the new configuration, you need to clear Jest's cache directory."),e.k0s(),e.j41(430,"p"),e.EFF(431,"To clear the cache directory, run the following command in your NestJS project folder:"),e.k0s(),e.j41(432,"pre")(433,"code",19),e.EFF(434,"\n$ npx jest --clearCache\n"),e.k0s()(),e.j41(435,"p"),e.EFF(436,"In case the automatic cache clearance fails, you can still manually remove the cache folder with the following commands:"),e.k0s(),e.j41(437,"pre")(438,"code",19),e.EFF(439,'\n# Find jest cache directory (usually /tmp/jest_rs)\n# by running the following command in your NestJS project root\n$ npx jest --showConfig | grep cache\n# ex result:\n#   "cache": true,\n#   "cacheDirectory": "/tmp/jest_rs"\n\n# Remove or empty the Jest cache directory\n$ rm -rf  <cacheDirectory value>\n# ex:\n# rm -rf /tmp/jest_rs\n'),e.k0s()()())},dependencies:[i.a,F.Wk],encapsulation:2,changeDetection:0})}return t})(),u=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-decorators"]],features:[e.Vt3],decls:141,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/decorators.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","decorators"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Decorators"),e.k0s(),e.j41(7,"p"),e.EFF(8,"All of the available OpenAPI decorators have an "),e.j41(9,"code"),e.EFF(10,"Api"),e.k0s(),e.EFF(11," prefix to distinguish them from the core decorators. Below is a full list of the exported decorators along with a designation of the level at which the decorator may be applied."),e.k0s(),e.j41(12,"table"),e.nrm(13,"thead"),e.j41(14,"tbody")(15,"tr")(16,"td")(17,"code"),e.EFF(18,"@ApiBasicAuth()"),e.k0s()(),e.j41(19,"td"),e.EFF(20,"Method / Controller"),e.k0s()(),e.j41(21,"tr")(22,"td")(23,"code"),e.EFF(24,"@ApiBearerAuth()"),e.k0s()(),e.j41(25,"td"),e.EFF(26,"Method / Controller"),e.k0s()(),e.j41(27,"tr")(28,"td")(29,"code"),e.EFF(30,"@ApiBody()"),e.k0s()(),e.j41(31,"td"),e.EFF(32,"Method"),e.k0s()(),e.j41(33,"tr")(34,"td")(35,"code"),e.EFF(36,"@ApiConsumes()"),e.k0s()(),e.j41(37,"td"),e.EFF(38,"Method / Controller"),e.k0s()(),e.j41(39,"tr")(40,"td")(41,"code"),e.EFF(42,"@ApiCookieAuth()"),e.k0s()(),e.j41(43,"td"),e.EFF(44,"Method / Controller"),e.k0s()(),e.j41(45,"tr")(46,"td")(47,"code"),e.EFF(48,"@ApiExcludeController()"),e.k0s()(),e.j41(49,"td"),e.EFF(50,"Controller"),e.k0s()(),e.j41(51,"tr")(52,"td")(53,"code"),e.EFF(54,"@ApiExcludeEndpoint()"),e.k0s()(),e.j41(55,"td"),e.EFF(56,"Method"),e.k0s()(),e.j41(57,"tr")(58,"td")(59,"code"),e.EFF(60,"@ApiExtension()"),e.k0s()(),e.j41(61,"td"),e.EFF(62,"Method"),e.k0s()(),e.j41(63,"tr")(64,"td")(65,"code"),e.EFF(66,"@ApiExtraModels()"),e.k0s()(),e.j41(67,"td"),e.EFF(68,"Method / Controller"),e.k0s()(),e.j41(69,"tr")(70,"td")(71,"code"),e.EFF(72,"@ApiHeader()"),e.k0s()(),e.j41(73,"td"),e.EFF(74,"Method / Controller"),e.k0s()(),e.j41(75,"tr")(76,"td")(77,"code"),e.EFF(78,"@ApiHideProperty()"),e.k0s()(),e.j41(79,"td"),e.EFF(80,"Model"),e.k0s()(),e.j41(81,"tr")(82,"td")(83,"code"),e.EFF(84,"@ApiOAuth2()"),e.k0s()(),e.j41(85,"td"),e.EFF(86,"Method / Controller"),e.k0s()(),e.j41(87,"tr")(88,"td")(89,"code"),e.EFF(90,"@ApiOperation()"),e.k0s()(),e.j41(91,"td"),e.EFF(92,"Method"),e.k0s()(),e.j41(93,"tr")(94,"td")(95,"code"),e.EFF(96,"@ApiParam()"),e.k0s()(),e.j41(97,"td"),e.EFF(98,"Method"),e.k0s()(),e.j41(99,"tr")(100,"td")(101,"code"),e.EFF(102,"@ApiProduces()"),e.k0s()(),e.j41(103,"td"),e.EFF(104,"Method / Controller"),e.k0s()(),e.j41(105,"tr")(106,"td")(107,"code"),e.EFF(108,"@ApiProperty()"),e.k0s()(),e.j41(109,"td"),e.EFF(110,"Model"),e.k0s()(),e.j41(111,"tr")(112,"td")(113,"code"),e.EFF(114,"@ApiPropertyOptional()"),e.k0s()(),e.j41(115,"td"),e.EFF(116,"Model"),e.k0s()(),e.j41(117,"tr")(118,"td")(119,"code"),e.EFF(120,"@ApiQuery()"),e.k0s()(),e.j41(121,"td"),e.EFF(122,"Method"),e.k0s()(),e.j41(123,"tr")(124,"td")(125,"code"),e.EFF(126,"@ApiResponse()"),e.k0s()(),e.j41(127,"td"),e.EFF(128,"Method / Controller"),e.k0s()(),e.j41(129,"tr")(130,"td")(131,"code"),e.EFF(132,"@ApiSecurity()"),e.k0s()(),e.j41(133,"td"),e.EFF(134,"Method / Controller"),e.k0s()(),e.j41(135,"tr")(136,"td")(137,"code"),e.EFF(138,"@ApiTags()"),e.k0s()(),e.j41(139,"td"),e.EFF(140,"Method / Controller"),e.k0s()()()()())},encapsulation:2,changeDetection:0})}return t})();var E=a(5119),h=a(5663);let m=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-introduction"]],features:[e.Vt3],decls:185,vars:4,consts:[["contentReference",""],["appb1db4860ee870d67ddd0b4c5026450872c54a076",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/introduction.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","introduction"],["rel","nofollow","target","_blank","href","https://swagger.io/specification/"],["rel","nofollow","target","_blank","href","https://github.com/nestjs/swagger"],["appAnchor","","id","installation"],[1,"language-bash"],["appAnchor","","id","bootstrap"],[1,"filename"],[1,"language-typescript"],[1,"info"],["rel","nofollow","target","_blank","href","https://swagger.io/specification/#openapi-document"],["href","/openapi/introduction#document-options"],["href","/openapi/introduction#setup-options"],["src","/assets/swagger1.png"],[1,"warning"],["rel","nofollow","target","_blank","href","https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"],["appAnchor","","id","document-options"],[1,"language-TypeScript"],["appAnchor","","id","setup-options"],["appAnchor","","id","example"],["rel","nofollow","target","_blank","href","https://github.com/nestjs/nest/tree/master/sample/11-swagger"]],template:function(n,s){if(1&n&&(e.j41(0,"div",2,0)(2,"div",3)(3,"a",4),e.nrm(4,"i",5),e.k0s()(),e.j41(5,"h3",6),e.EFF(6,"Introduction"),e.k0s(),e.j41(7,"p"),e.EFF(8,"The "),e.j41(9,"a",7),e.EFF(10,"OpenAPI"),e.k0s(),e.EFF(11," specification is a language-agnostic definition format used to describe RESTful APIs. Nest provides a dedicated "),e.j41(12,"a",8),e.EFF(13,"module"),e.k0s(),e.EFF(14," which allows generating such a specification by leveraging decorators."),e.k0s(),e.j41(15,"h4",9)(16,"span"),e.EFF(17,"Installation"),e.k0s()(),e.j41(18,"p"),e.EFF(19,"To begin using it, we first install the required dependency."),e.k0s(),e.j41(20,"pre")(21,"code",10),e.EFF(22,"\n$ npm install --save @nestjs/swagger\n"),e.k0s()(),e.j41(23,"h4",11)(24,"span"),e.EFF(25,"Bootstrap"),e.k0s()(),e.j41(26,"p"),e.EFF(27,"Once the installation process is complete, open the "),e.j41(28,"code"),e.EFF(29,"main.ts"),e.k0s(),e.EFF(30," file and initialize Swagger using the "),e.j41(31,"code"),e.EFF(32,"SwaggerModule"),e.k0s(),e.EFF(33," class:"),e.k0s(),e.j41(34,"span",12),e.EFF(35),e.nI1(36,"extension"),e.nrm(37,"app-tabs",null,1),e.k0s(),e.j41(39,"pre")(40,"code",13),e.EFF(41,"\nimport { NestFactory } from '@nestjs/core';\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nimport { AppModule } from './app.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n\n  const config = new DocumentBuilder()\n    .setTitle('Cats example')\n    .setDescription('The cats API description')\n    .setVersion('1.0')\n    .addTag('cats')\n    .build();\n  const document = SwaggerModule.createDocument(app, config);\n  SwaggerModule.setup('api', app, document);\n\n  await app.listen(process.env.PORT ?? 3000);\n}\nbootstrap();\n"),e.k0s()(),e.j41(42,"blockquote",14)(43,"strong"),e.EFF(44,"Hint"),e.k0s(),e.j41(45,"code"),e.EFF(46,"document"),e.k0s(),e.EFF(47," (returned by the "),e.j41(48,"code"),e.EFF(49,"SwaggerModule#createDocument()"),e.k0s(),e.EFF(50," method) is a serializable object conforming to "),e.j41(51,"a",15),e.EFF(52,"OpenAPI Document"),e.k0s(),e.EFF(53,". Instead of hosting it via HTTP, you could also save it as a JSON/YAML file, and consume it in different ways.\n"),e.k0s(),e.j41(54,"p"),e.EFF(55,"The "),e.j41(56,"code"),e.EFF(57,"DocumentBuilder"),e.k0s(),e.EFF(58," helps to structure a base document that conforms to the OpenAPI Specification. It provides several methods that allow setting such properties as title, description, version, etc. In order to create a full document (with all HTTP routes defined) we use the "),e.j41(59,"code"),e.EFF(60,"createDocument()"),e.k0s(),e.EFF(61," method of the "),e.j41(62,"code"),e.EFF(63,"SwaggerModule"),e.k0s(),e.EFF(64," class. This method takes two arguments, an application instance and a Swagger options object. Alternatively, we can provide a third argument, which should be of type "),e.j41(65,"code"),e.EFF(66,"SwaggerDocumentOptions"),e.k0s(),e.EFF(67,". More on this in the "),e.j41(68,"a",16),e.EFF(69,"Document options section"),e.k0s(),e.EFF(70,"."),e.k0s(),e.j41(71,"p"),e.EFF(72,"Once we create a document, we can call the "),e.j41(73,"code"),e.EFF(74,"setup()"),e.k0s(),e.EFF(75," method. It accepts:"),e.k0s(),e.j41(76,"ol")(77,"li"),e.EFF(78,"The path to mount the Swagger UI"),e.k0s(),e.j41(79,"li"),e.EFF(80,"An application instance"),e.k0s(),e.j41(81,"li"),e.EFF(82,"The document object instantiated above"),e.k0s(),e.j41(83,"li"),e.EFF(84,"Optional configuration parameter (read more "),e.j41(85,"a",17),e.EFF(86,"here"),e.k0s(),e.EFF(87,")"),e.k0s()(),e.j41(88,"p"),e.EFF(89,"Now you can run the following command to start the HTTP server:"),e.k0s(),e.j41(90,"pre")(91,"code",10),e.EFF(92,"\n$ npm run start\n"),e.k0s()(),e.j41(93,"p"),e.EFF(94,"While the application is running, open your browser and navigate to "),e.j41(95,"code"),e.EFF(96,"http://localhost:3000/api"),e.k0s(),e.EFF(97,". You should see the Swagger UI."),e.k0s(),e.j41(98,"figure"),e.nrm(99,"img",18),e.k0s(),e.j41(100,"p"),e.EFF(101,"As you can see, the "),e.j41(102,"code"),e.EFF(103,"SwaggerModule"),e.k0s(),e.EFF(104," automatically reflects all of your endpoints."),e.k0s(),e.j41(105,"blockquote",14)(106,"strong"),e.EFF(107,"Hint"),e.k0s(),e.EFF(108," To generate and download a Swagger JSON file, navigate to "),e.j41(109,"code"),e.EFF(110,"http://localhost:3000/api-json"),e.k0s(),e.EFF(111," (assuming that your Swagger documentation is available under "),e.j41(112,"code"),e.EFF(113,"http://localhost:3000/api"),e.k0s(),e.EFF(114,").\nIt is also possible to expose it on a route of your choice using only the setup method from "),e.j41(115,"code"),e.EFF(116,"@nestjs/swagger"),e.k0s(),e.EFF(117,", like this:\n"),e.j41(118,"pre")(119,"code",13),e.EFF(120,"\nSwaggerModule.setup('swagger', app, document, {\n  jsonDocumentUrl: 'swagger/json',\n});\n"),e.k0s()(),e.j41(121,"p"),e.EFF(122,"Which would expose it at "),e.j41(123,"code"),e.EFF(124,"http://localhost:3000/swagger/json"),e.k0s()()(),e.j41(125,"blockquote",19)(126,"strong"),e.EFF(127,"Warning"),e.k0s(),e.EFF(128," When using "),e.j41(129,"code"),e.EFF(130,"fastify"),e.k0s(),e.EFF(131," and "),e.j41(132,"code"),e.EFF(133,"helmet"),e.k0s(),e.EFF(134,", there may be a problem with "),e.j41(135,"a",20),e.EFF(136,"CSP"),e.k0s(),e.EFF(137,", to solve this collision, configure the CSP as shown below:\n"),e.j41(138,"pre")(139,"code",13),e.EFF(140,"\napp.register(helmet, {\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [`'self'`],\n      styleSrc: [`'self'`, `'unsafe-inline'`],\n      imgSrc: [`'self'`, 'data:', 'validator.swagger.io'],\n      scriptSrc: [`'self'`, `https: 'unsafe-inline'`],\n    },\n  },\n});\n\n// If you are not going to use CSP at all, you can use this:\napp.register(helmet, {\n  contentSecurityPolicy: false,\n});\n"),e.k0s()()(),e.j41(141,"h4",21)(142,"span"),e.EFF(143,"Document options"),e.k0s()(),e.j41(144,"p"),e.EFF(145,"When creating a document, it is possible to provide some extra options to fine tune the library's behavior. These options should be of type "),e.j41(146,"code"),e.EFF(147,"SwaggerDocumentOptions"),e.k0s(),e.EFF(148,", which can be the following:"),e.k0s(),e.j41(149,"pre")(150,"code",22),e.EFF(151,"\nexport interface SwaggerDocumentOptions {\n  /**\n   * List of modules to include in the specification\n   */\n  include?: Function[];\n\n  /**\n   * Additional, extra models that should be inspected and included in the specification\n   */\n  extraModels?: Function[];\n\n  /**\n   * If `true`, swagger will ignore the global prefix set through `setGlobalPrefix()` method\n   */\n  ignoreGlobalPrefix?: boolean;\n\n  /**\n   * If `true`, swagger will also load routes from the modules imported by `include` modules\n   */\n  deepScanRoutes?: boolean;\n\n  /**\n   * Custom operationIdFactory that will be used to generate the `operationId`\n   * based on the `controllerKey` and `methodKey`\n   * @default () => controllerKey_methodKey\n   */\n  operationIdFactory?: (controllerKey: string, methodKey: string) => string;\n}\n"),e.k0s()(),e.j41(152,"p"),e.EFF(153,"For example, if you want to make sure that the library generates operation names like "),e.j41(154,"code"),e.EFF(155,"createUser"),e.k0s(),e.EFF(156," instead of "),e.j41(157,"code"),e.EFF(158,"UserController_createUser"),e.k0s(),e.EFF(159,", you can set the following:"),e.k0s(),e.j41(160,"pre")(161,"code",22),e.EFF(162,"\nconst options: SwaggerDocumentOptions =  {\n  operationIdFactory: (\n    controllerKey: string,\n    methodKey: string\n  ) => methodKey\n};\nconst document = SwaggerModule.createDocument(app, config, options);\n"),e.k0s()(),e.j41(163,"h4",23)(164,"span"),e.EFF(165,"Setup options"),e.k0s()(),e.j41(166,"p"),e.EFF(167,"You can configure Swagger UI by passing the options object which fulfills the "),e.j41(168,"code"),e.EFF(169,"SwaggerCustomOptions"),e.k0s(),e.EFF(170," interface as a fourth argument of the "),e.j41(171,"code"),e.EFF(172,"SwaggerModule#setup"),e.k0s(),e.EFF(173," method."),e.k0s(),e.j41(174,"pre")(175,"code",22),e.EFF(176,"\nexport interface SwaggerCustomOptions {\n  /**\n   * If `true`, Swagger resources paths will be prefixed by the global prefix set through `setGlobalPrefix()`.\n   * Default: `false`.\n   * @see https://docs.nestjs.com/faq/global-prefix\n   */\n  useGlobalPrefix?: boolean;\n\n  /**\n   * If `false`, only API definitions (JSON and YAML) will be served (on `/{path}-json` and `/{path}-yaml`).\n   * This is particularly useful if you are already hosting a Swagger UI somewhere else and just want to serve API definitions.\n   * Default: `true`.\n   */\n  swaggerUiEnabled?: boolean;\n\n  /**\n   * Url point the API definition to load in Swagger UI.\n   */\n  swaggerUrl?: string;\n\n  /**\n   * Path of the JSON API definition to serve.\n   * Default: `<path>-json`.\n   */\n  jsonDocumentUrl?: string;\n\n  /**\n   * Path of the YAML API definition to serve.\n   * Default: `<path>-yaml`.\n   */\n  yamlDocumentUrl?: string;\n\n  /**\n   * Hook allowing to alter the OpenAPI document before being served.\n   * It's called after the document is generated and before it is served as JSON & YAML.\n   */\n  patchDocumentOnRequest?: <TRequest = any, TResponse = any>(\n    req: TRequest,\n    res: TResponse,\n    document: OpenAPIObject\n  ) => OpenAPIObject;\n\n  /**\n   * If `true`, the selector of OpenAPI definitions is displayed in the Swagger UI interface.\n   * Default: `false`.\n   *\n   * When `true` and `swaggerOptions.urls` is provided, a dropdown labeled \"Select a definition\"\n   * is shown in the Swagger UI, allowing users to select from the available API definitions\n   * specified in the `urls` array.\n   */\n  explorer?: boolean;\n\n  /**\n   * Additional Swagger UI options\n   */\n  swaggerOptions?: SwaggerUiOptions;\n\n  /**\n   * Custom CSS styles to inject in Swagger UI page.\n   */\n  customCss?: string;\n\n  /**\n   * URL(s) of a custom CSS stylesheet to load in Swagger UI page.\n   */\n  customCssUrl?: string | string[];\n\n  /**\n   * URL(s) of custom JavaScript files to load in Swagger UI page.\n   */\n  customJs?: string | string[];\n\n  /**\n   * Custom JavaScript scripts to load in Swagger UI page.\n   */\n  customJsStr?: string | string[];\n\n  /**\n   * Custom favicon for Swagger UI page.\n   */\n  customfavIcon?: string;\n\n  /**\n   * Custom title for Swagger UI page.\n   */\n  customSiteTitle?: string;\n\n  /**\n   * File system path (ex: ./node_modules/swagger-ui-dist) containing static Swagger UI assets.\n   */\n  customSwaggerUiPath?: string;\n\n  /**\n   * @deprecated This property has no effect.\n   */\n  validatorUrl?: string;\n\n  /**\n   * @deprecated This property has no effect.\n   */\n  url?: string;\n\n  /**\n   * @deprecated This property has no effect.\n   */\n  urls?: Record<'url' | 'name', string>[];\n\n}\n"),e.k0s()(),e.j41(177,"h4",24)(178,"span"),e.EFF(179,"Example"),e.k0s()(),e.j41(180,"p"),e.EFF(181,"A working example is available "),e.j41(182,"a",25),e.EFF(183,"here"),e.k0s(),e.EFF(184,"."),e.k0s()()),2&n){const P=e.sdS(38);e.R7$(35),e.SpI(" ",e.i5U(36,1,"main",P.isJsActive),"\n")}},dependencies:[E.O,i.a,h.M],encapsulation:2,changeDetection:0})}return t})(),g=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-mapped-types"]],features:[e.Vt3],decls:169,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/mapped-types.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","mapped-types"],["appAnchor","","id","partial"],[1,"language-typescript"],[1,"info"],["appAnchor","","id","pick"],["appAnchor","","id","omit"],["appAnchor","","id","intersection"],["appAnchor","","id","composition"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Mapped types"),e.k0s(),e.j41(7,"p"),e.EFF(8,"As you build out features like "),e.j41(9,"strong"),e.EFF(10,"CRUD"),e.k0s(),e.EFF(11," (Create/Read/Update/Delete) it's often useful to construct variants on a base entity type. Nest provides several utility functions that perform type transformations to make this task more convenient."),e.k0s(),e.j41(12,"h4",6)(13,"span"),e.EFF(14,"Partial"),e.k0s()(),e.j41(15,"p"),e.EFF(16,"When building input validation types (also called DTOs), it's often useful to build "),e.j41(17,"strong"),e.EFF(18,"create"),e.k0s(),e.EFF(19," and "),e.j41(20,"strong"),e.EFF(21,"update"),e.k0s(),e.EFF(22," variations on the same type. For example, the "),e.j41(23,"strong"),e.EFF(24,"create"),e.k0s(),e.EFF(25," variant may require all fields, while the "),e.j41(26,"strong"),e.EFF(27,"update"),e.k0s(),e.EFF(28," variant may make all fields optional."),e.k0s(),e.j41(29,"p"),e.EFF(30,"Nest provides the "),e.j41(31,"code"),e.EFF(32,"PartialType()"),e.k0s(),e.EFF(33," utility function to make this task easier and minimize boilerplate."),e.k0s(),e.j41(34,"p"),e.EFF(35,"The "),e.j41(36,"code"),e.EFF(37,"PartialType()"),e.k0s(),e.EFF(38," function returns a type (class) with all the properties of the input type set to optional. For example, suppose we have a "),e.j41(39,"strong"),e.EFF(40,"create"),e.k0s(),e.EFF(41," type as follows:"),e.k0s(),e.j41(42,"pre")(43,"code",7),e.EFF(44,"\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateCatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(45,"p"),e.EFF(46,"By default, all of these fields are required. To create a type with the same fields, but with each one optional, use "),e.j41(47,"code"),e.EFF(48,"PartialType()"),e.k0s(),e.EFF(49," passing the class reference ("),e.j41(50,"code"),e.EFF(51,"CreateCatDto"),e.k0s(),e.EFF(52,") as an argument:"),e.k0s(),e.j41(53,"pre")(54,"code",7),e.EFF(55,"\nexport class UpdateCatDto extends PartialType(CreateCatDto) {}\n"),e.k0s()(),e.j41(56,"blockquote",8)(57,"strong"),e.EFF(58,"Hint"),e.k0s(),e.EFF(59," The "),e.j41(60,"code"),e.EFF(61,"PartialType()"),e.k0s(),e.EFF(62," function is imported from the "),e.j41(63,"code"),e.EFF(64,"@nestjs/swagger"),e.k0s(),e.EFF(65," package.\n"),e.k0s(),e.j41(66,"h4",9)(67,"span"),e.EFF(68,"Pick"),e.k0s()(),e.j41(69,"p"),e.EFF(70,"The "),e.j41(71,"code"),e.EFF(72,"PickType()"),e.k0s(),e.EFF(73," function constructs a new type (class) by picking a set of properties from an input type. For example, suppose we start with a type like:"),e.k0s(),e.j41(74,"pre")(75,"code",7),e.EFF(76,"\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateCatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(77,"p"),e.EFF(78,"We can pick a set of properties from this class using the "),e.j41(79,"code"),e.EFF(80,"PickType()"),e.k0s(),e.EFF(81," utility function:"),e.k0s(),e.j41(82,"pre")(83,"code",7),e.EFF(84,"\nexport class UpdateCatAgeDto extends PickType(CreateCatDto, ['age'] as const) {}\n"),e.k0s()(),e.j41(85,"blockquote",8)(86,"strong"),e.EFF(87,"Hint"),e.k0s(),e.EFF(88," The "),e.j41(89,"code"),e.EFF(90,"PickType()"),e.k0s(),e.EFF(91," function is imported from the "),e.j41(92,"code"),e.EFF(93,"@nestjs/swagger"),e.k0s(),e.EFF(94," package.\n"),e.k0s(),e.j41(95,"h4",10)(96,"span"),e.EFF(97,"Omit"),e.k0s()(),e.j41(98,"p"),e.EFF(99,"The "),e.j41(100,"code"),e.EFF(101,"OmitType()"),e.k0s(),e.EFF(102," function constructs a type by picking all properties from an input type and then removing a particular set of keys. For example, suppose we start with a type like:"),e.k0s(),e.j41(103,"pre")(104,"code",7),e.EFF(105,"\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateCatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(106,"p"),e.EFF(107,"We can generate a derived type that has every property "),e.j41(108,"strong"),e.EFF(109,"except"),e.k0s(),e.j41(110,"code"),e.EFF(111,"name"),e.k0s(),e.EFF(112," as shown below. In this construct, the second argument to "),e.j41(113,"code"),e.EFF(114,"OmitType"),e.k0s(),e.EFF(115," is an array of property names."),e.k0s(),e.j41(116,"pre")(117,"code",7),e.EFF(118,"\nexport class UpdateCatDto extends OmitType(CreateCatDto, ['name'] as const) {}\n"),e.k0s()(),e.j41(119,"blockquote",8)(120,"strong"),e.EFF(121,"Hint"),e.k0s(),e.EFF(122," The "),e.j41(123,"code"),e.EFF(124,"OmitType()"),e.k0s(),e.EFF(125," function is imported from the "),e.j41(126,"code"),e.EFF(127,"@nestjs/swagger"),e.k0s(),e.EFF(128," package.\n"),e.k0s(),e.j41(129,"h4",11)(130,"span"),e.EFF(131,"Intersection"),e.k0s()(),e.j41(132,"p"),e.EFF(133,"The "),e.j41(134,"code"),e.EFF(135,"IntersectionType()"),e.k0s(),e.EFF(136," function combines two types into one new type (class). For example, suppose we start with two types like:"),e.k0s(),e.j41(137,"pre")(138,"code",7),e.EFF(139,"\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateCatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  breed: string;\n}\n\nexport class AdditionalCatInfo {\n  @ApiProperty()\n  color: string;\n}\n"),e.k0s()(),e.j41(140,"p"),e.EFF(141,"We can generate a new type that combines all properties in both types."),e.k0s(),e.j41(142,"pre")(143,"code",7),e.EFF(144,"\nexport class UpdateCatDto extends IntersectionType(\n  CreateCatDto,\n  AdditionalCatInfo,\n) {}\n"),e.k0s()(),e.j41(145,"blockquote",8)(146,"strong"),e.EFF(147,"Hint"),e.k0s(),e.EFF(148," The "),e.j41(149,"code"),e.EFF(150,"IntersectionType()"),e.k0s(),e.EFF(151," function is imported from the "),e.j41(152,"code"),e.EFF(153,"@nestjs/swagger"),e.k0s(),e.EFF(154," package.\n"),e.k0s(),e.j41(155,"h4",12)(156,"span"),e.EFF(157,"Composition"),e.k0s()(),e.j41(158,"p"),e.EFF(159,"The type mapping utility functions are composable. For example, the following will produce a type (class) that has all of the properties of the "),e.j41(160,"code"),e.EFF(161,"CreateCatDto"),e.k0s(),e.EFF(162," type except for "),e.j41(163,"code"),e.EFF(164,"name"),e.k0s(),e.EFF(165,", and those properties will be set to optional:"),e.k0s(),e.j41(166,"pre")(167,"code",7),e.EFF(168,"\nexport class UpdateCatDto extends PartialType(\n  OmitType(CreateCatDto, ['name'] as const),\n) {}\n"),e.k0s()()())},dependencies:[i.a],encapsulation:2,changeDetection:0})}return t})();var k=a(7077);let j=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-openapi-migration"]],features:[e.Vt3],decls:129,vars:4,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/migration-guide.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","migration-guide"],["appAnchor","","id","breaking-changes"],["appAnchor","","id","new-methods"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Migration guide"),e.k0s(),e.j41(7,"p"),e.EFF(8,"If you're currently using "),e.j41(9,"code"),e.EFF(10,"@nestjs/swagger@3.*"),e.k0s(),e.EFF(11,", note the following breaking/API changes in version 4.0."),e.k0s(),e.j41(12,"h4",6)(13,"span"),e.EFF(14,"Breaking changes"),e.k0s()(),e.j41(15,"p"),e.EFF(16,"The following decorators have been changed/renamed:"),e.k0s(),e.j41(17,"ul")(18,"li")(19,"code"),e.EFF(20,"@ApiModelProperty"),e.k0s(),e.EFF(21," is now "),e.j41(22,"code"),e.EFF(23,"@ApiProperty"),e.k0s()(),e.j41(24,"li")(25,"code"),e.EFF(26,"@ApiModelPropertyOptional"),e.k0s(),e.EFF(27," is now "),e.j41(28,"code"),e.EFF(29,"@ApiPropertyOptional"),e.k0s()(),e.j41(30,"li")(31,"code"),e.EFF(32,"@ApiResponseModelProperty"),e.k0s(),e.EFF(33," is now "),e.j41(34,"code"),e.EFF(35,"@ApiResponseProperty"),e.k0s()(),e.j41(36,"li")(37,"code"),e.EFF(38,"@ApiImplicitQuery"),e.k0s(),e.EFF(39," is now "),e.j41(40,"code"),e.EFF(41,"@ApiQuery"),e.k0s()(),e.j41(42,"li")(43,"code"),e.EFF(44,"@ApiImplicitParam"),e.k0s(),e.EFF(45," is now "),e.j41(46,"code"),e.EFF(47,"@ApiParam"),e.k0s()(),e.j41(48,"li")(49,"code"),e.EFF(50,"@ApiImplicitBody"),e.k0s(),e.EFF(51," is now "),e.j41(52,"code"),e.EFF(53,"@ApiBody"),e.k0s()(),e.j41(54,"li")(55,"code"),e.EFF(56,"@ApiImplicitHeader"),e.k0s(),e.EFF(57," is now "),e.j41(58,"code"),e.EFF(59,"@ApiHeader"),e.k0s()(),e.j41(60,"li")(61,"code"),e.EFF(62),e.k0s(),e.EFF(63," is now "),e.j41(64,"code"),e.EFF(65),e.k0s()(),e.j41(66,"li")(67,"code"),e.EFF(68,"@ApiUseTags"),e.k0s(),e.EFF(69," is now "),e.j41(70,"code"),e.EFF(71,"@ApiTags"),e.k0s()()(),e.j41(72,"p")(73,"code"),e.EFF(74,"DocumentBuilder"),e.k0s(),e.EFF(75," breaking changes (updated method signatures):"),e.k0s(),e.j41(76,"ul")(77,"li")(78,"code"),e.EFF(79,"addTag"),e.k0s()(),e.j41(80,"li")(81,"code"),e.EFF(82,"addBearerAuth"),e.k0s()(),e.j41(83,"li")(84,"code"),e.EFF(85,"addOAuth2"),e.k0s()(),e.j41(86,"li")(87,"code"),e.EFF(88,"setContactEmail"),e.k0s(),e.EFF(89," is now "),e.j41(90,"code"),e.EFF(91,"setContact"),e.k0s()(),e.j41(92,"li")(93,"code"),e.EFF(94,"setHost"),e.k0s(),e.EFF(95," has been removed"),e.k0s(),e.j41(96,"li")(97,"code"),e.EFF(98,"setSchemes"),e.k0s(),e.EFF(99," has been removed (use the "),e.j41(100,"code"),e.EFF(101,"addServer"),e.k0s(),e.EFF(102," instead, e.g., "),e.j41(103,"code"),e.EFF(104,"addServer('http://')"),e.k0s(),e.EFF(105,")"),e.k0s()(),e.j41(106,"h4",7)(107,"span"),e.EFF(108,"New methods"),e.k0s()(),e.j41(109,"p"),e.EFF(110,"The following methods have been added:"),e.k0s(),e.j41(111,"ul")(112,"li")(113,"code"),e.EFF(114,"addServer"),e.k0s()(),e.j41(115,"li")(116,"code"),e.EFF(117,"addApiKey"),e.k0s()(),e.j41(118,"li")(119,"code"),e.EFF(120,"addBasicAuth"),e.k0s()(),e.j41(121,"li")(122,"code"),e.EFF(123,"addSecurity"),e.k0s()(),e.j41(124,"li")(125,"code"),e.EFF(126,"addSecurityRequirements"),e.k0s()()(),e.j41(127,"p"),e.nrm(128,"app-banner-devtools"),e.k0s()()),2&n&&(e.R7$(62),e.Lme("@ApiOperation(","{"," title: 'test' ","}",")"),e.R7$(3),e.Lme("@ApiOperation(","{"," summary: 'test' ","}",")"))},dependencies:[i.a,k._],encapsulation:2,changeDetection:0})}return t})(),f=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-openapi-operations"]],features:[e.Vt3],decls:366,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/operations.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","operations"],["appAnchor","","id","tags"],[1,"language-typescript"],["appAnchor","","id","headers"],["appAnchor","","id","responses"],["src","/assets/swagger-response-type.png"],["appAnchor","","id","file-upload"],["routerLink","/techniques/file-upload"],["appAnchor","","id","extensions"],["appAnchor","","id","advanced-generic-apiresponse"],["href","/openapi/types-and-parameters#raw-definitions"],[1,"language-ts"],["href","/openapi/types-and-parameters#extra-models"],[1,"language-json"],[1,"info"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Operations"),e.k0s(),e.j41(7,"p"),e.EFF(8,"In OpenAPI terms, paths are endpoints (resources), such as "),e.j41(9,"code"),e.EFF(10,"/users"),e.k0s(),e.EFF(11," or "),e.j41(12,"code"),e.EFF(13,"/reports/summary"),e.k0s(),e.EFF(14,", that your API exposes, and operations are the HTTP methods used to manipulate these paths, such as "),e.j41(15,"code"),e.EFF(16,"GET"),e.k0s(),e.EFF(17,", "),e.j41(18,"code"),e.EFF(19,"POST"),e.k0s(),e.EFF(20," or "),e.j41(21,"code"),e.EFF(22,"DELETE"),e.k0s(),e.EFF(23,"."),e.k0s(),e.j41(24,"h4",6)(25,"span"),e.EFF(26,"Tags"),e.k0s()(),e.j41(27,"p"),e.EFF(28,"To attach a controller to a specific tag, use the "),e.j41(29,"code"),e.EFF(30,"@ApiTags(...tags)"),e.k0s(),e.EFF(31," decorator."),e.k0s(),e.j41(32,"pre")(33,"code",7),e.EFF(34,"\n@ApiTags('cats')\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(35,"h4",8)(36,"span"),e.EFF(37,"Headers"),e.k0s()(),e.j41(38,"p"),e.EFF(39,"To define custom headers that are expected as part of the request, use "),e.j41(40,"code"),e.EFF(41,"@ApiHeader()"),e.k0s(),e.EFF(42,"."),e.k0s(),e.j41(43,"pre")(44,"code",7),e.EFF(45,"\n@ApiHeader({\n  name: 'X-MyHeader',\n  description: 'Custom header',\n})\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(46,"h4",9)(47,"span"),e.EFF(48,"Responses"),e.k0s()(),e.j41(49,"p"),e.EFF(50,"To define a custom HTTP response, use the "),e.j41(51,"code"),e.EFF(52,"@ApiResponse()"),e.k0s(),e.EFF(53," decorator."),e.k0s(),e.j41(54,"pre")(55,"code",7),e.EFF(56,"\n@Post()\n@ApiResponse({ status: 201, description: 'The record has been successfully created.'})\n@ApiResponse({ status: 403, description: 'Forbidden.'})\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n"),e.k0s()(),e.j41(57,"p"),e.EFF(58,"Nest provides a set of short-hand "),e.j41(59,"strong"),e.EFF(60,"API response"),e.k0s(),e.EFF(61," decorators that inherit from the "),e.j41(62,"code"),e.EFF(63,"@ApiResponse"),e.k0s(),e.EFF(64," decorator:"),e.k0s(),e.j41(65,"ul")(66,"li")(67,"code"),e.EFF(68,"@ApiOkResponse()"),e.k0s()(),e.j41(69,"li")(70,"code"),e.EFF(71,"@ApiCreatedResponse()"),e.k0s()(),e.j41(72,"li")(73,"code"),e.EFF(74,"@ApiAcceptedResponse()"),e.k0s()(),e.j41(75,"li")(76,"code"),e.EFF(77,"@ApiNoContentResponse()"),e.k0s()(),e.j41(78,"li")(79,"code"),e.EFF(80,"@ApiMovedPermanentlyResponse()"),e.k0s()(),e.j41(81,"li")(82,"code"),e.EFF(83,"@ApiFoundResponse()"),e.k0s()(),e.j41(84,"li")(85,"code"),e.EFF(86,"@ApiBadRequestResponse()"),e.k0s()(),e.j41(87,"li")(88,"code"),e.EFF(89,"@ApiUnauthorizedResponse()"),e.k0s()(),e.j41(90,"li")(91,"code"),e.EFF(92,"@ApiNotFoundResponse()"),e.k0s()(),e.j41(93,"li")(94,"code"),e.EFF(95,"@ApiForbiddenResponse()"),e.k0s()(),e.j41(96,"li")(97,"code"),e.EFF(98,"@ApiMethodNotAllowedResponse()"),e.k0s()(),e.j41(99,"li")(100,"code"),e.EFF(101,"@ApiNotAcceptableResponse()"),e.k0s()(),e.j41(102,"li")(103,"code"),e.EFF(104,"@ApiRequestTimeoutResponse()"),e.k0s()(),e.j41(105,"li")(106,"code"),e.EFF(107,"@ApiConflictResponse()"),e.k0s()(),e.j41(108,"li")(109,"code"),e.EFF(110,"@ApiPreconditionFailedResponse()"),e.k0s()(),e.j41(111,"li")(112,"code"),e.EFF(113,"@ApiTooManyRequestsResponse()"),e.k0s()(),e.j41(114,"li")(115,"code"),e.EFF(116,"@ApiGoneResponse()"),e.k0s()(),e.j41(117,"li")(118,"code"),e.EFF(119,"@ApiPayloadTooLargeResponse()"),e.k0s()(),e.j41(120,"li")(121,"code"),e.EFF(122,"@ApiUnsupportedMediaTypeResponse()"),e.k0s()(),e.j41(123,"li")(124,"code"),e.EFF(125,"@ApiUnprocessableEntityResponse()"),e.k0s()(),e.j41(126,"li")(127,"code"),e.EFF(128,"@ApiInternalServerErrorResponse()"),e.k0s()(),e.j41(129,"li")(130,"code"),e.EFF(131,"@ApiNotImplementedResponse()"),e.k0s()(),e.j41(132,"li")(133,"code"),e.EFF(134,"@ApiBadGatewayResponse()"),e.k0s()(),e.j41(135,"li")(136,"code"),e.EFF(137,"@ApiServiceUnavailableResponse()"),e.k0s()(),e.j41(138,"li")(139,"code"),e.EFF(140,"@ApiGatewayTimeoutResponse()"),e.k0s()(),e.j41(141,"li")(142,"code"),e.EFF(143,"@ApiDefaultResponse()"),e.k0s()()(),e.j41(144,"pre")(145,"code",7),e.EFF(146,"\n@Post()\n@ApiCreatedResponse({ description: 'The record has been successfully created.'})\n@ApiForbiddenResponse({ description: 'Forbidden.'})\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n"),e.k0s()(),e.j41(147,"p"),e.EFF(148,"To specify a return model for a request, we must create a class and annotate all properties with the "),e.j41(149,"code"),e.EFF(150,"@ApiProperty()"),e.k0s(),e.EFF(151," decorator."),e.k0s(),e.j41(152,"pre")(153,"code",7),e.EFF(154,"\nexport class Cat {\n  @ApiProperty()\n  id: number;\n\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(155,"p"),e.EFF(156,"Then the "),e.j41(157,"code"),e.EFF(158,"Cat"),e.k0s(),e.EFF(159," model can be used in combination with the "),e.j41(160,"code"),e.EFF(161,"type"),e.k0s(),e.EFF(162," property of the response decorator."),e.k0s(),e.j41(163,"pre")(164,"code",7),e.EFF(165,"\n@ApiTags('cats')\n@Controller('cats')\nexport class CatsController {\n  @Post()\n  @ApiCreatedResponse({\n    description: 'The record has been successfully created.',\n    type: Cat,\n  })\n  async create(@Body() createCatDto: CreateCatDto): Promise<Cat> {\n    return this.catsService.create(createCatDto);\n  }\n}\n"),e.k0s()(),e.j41(166,"p"),e.EFF(167,"Let's open the browser and verify the generated "),e.j41(168,"code"),e.EFF(169,"Cat"),e.k0s(),e.EFF(170," model:"),e.k0s(),e.j41(171,"figure"),e.nrm(172,"img",10),e.k0s(),e.j41(173,"h4",11)(174,"span"),e.EFF(175,"File upload"),e.k0s()(),e.j41(176,"p"),e.EFF(177,"You can enable file upload for a specific method with the "),e.j41(178,"code"),e.EFF(179,"@ApiBody"),e.k0s(),e.EFF(180," decorator together with "),e.j41(181,"code"),e.EFF(182,"@ApiConsumes()"),e.k0s(),e.EFF(183,". Here's a full example using the "),e.j41(184,"a",12),e.EFF(185,"File Upload"),e.k0s(),e.EFF(186," technique:"),e.k0s(),e.j41(187,"pre")(188,"code",7),e.EFF(189,"\n@UseInterceptors(FileInterceptor('file'))\n@ApiConsumes('multipart/form-data')\n@ApiBody({\n  description: 'List of cats',\n  type: FileUploadDto,\n})\nuploadFile(@UploadedFile() file) {}\n"),e.k0s()(),e.j41(190,"p"),e.EFF(191,"Where "),e.j41(192,"code"),e.EFF(193,"FileUploadDto"),e.k0s(),e.EFF(194," is defined as follows:"),e.k0s(),e.j41(195,"pre")(196,"code",7),e.EFF(197,"\nclass FileUploadDto {\n  @ApiProperty({ type: 'string', format: 'binary' })\n  file: any;\n}\n"),e.k0s()(),e.j41(198,"p"),e.EFF(199,"To handle multiple files uploading, you can define "),e.j41(200,"code"),e.EFF(201,"FilesUploadDto"),e.k0s(),e.EFF(202," as follows:"),e.k0s(),e.j41(203,"pre")(204,"code",7),e.EFF(205,"\nclass FilesUploadDto {\n  @ApiProperty({ type: 'array', items: { type: 'string', format: 'binary' } })\n  files: any[];\n}\n"),e.k0s()(),e.j41(206,"h4",13)(207,"span"),e.EFF(208,"Extensions"),e.k0s()(),e.j41(209,"p"),e.EFF(210,"To add an Extension to a request use the "),e.j41(211,"code"),e.EFF(212,"@ApiExtension()"),e.k0s(),e.EFF(213," decorator. The extension name must be prefixed with "),e.j41(214,"code"),e.EFF(215,"x-"),e.k0s(),e.EFF(216,"."),e.k0s(),e.j41(217,"pre")(218,"code",7),e.EFF(219,"\n@ApiExtension('x-foo', { hello: 'world' })\n"),e.k0s()(),e.j41(220,"h4",14)(221,"span"),e.EFF(222,"Advanced: Generic "),e.j41(223,"code"),e.EFF(224,"ApiResponse"),e.k0s()()(),e.j41(225,"p"),e.EFF(226,"With the ability to provide "),e.j41(227,"a",15),e.EFF(228,"Raw Definitions"),e.k0s(),e.EFF(229,", we can define Generic schema for Swagger UI. Assume we have the following DTO:"),e.k0s(),e.j41(230,"pre")(231,"code",16),e.EFF(232,"\nexport class PaginatedDto<TData> {\n  @ApiProperty()\n  total: number;\n\n  @ApiProperty()\n  limit: number;\n\n  @ApiProperty()\n  offset: number;\n\n  results: TData[];\n}\n"),e.k0s()(),e.j41(233,"p"),e.EFF(234,"We skip decorating "),e.j41(235,"code"),e.EFF(236,"results"),e.k0s(),e.EFF(237," as we will be providing a raw definition for it later. Now, let's define another DTO and name it, for example, "),e.j41(238,"code"),e.EFF(239,"CatDto"),e.k0s(),e.EFF(240,", as follows:"),e.k0s(),e.j41(241,"pre")(242,"code",16),e.EFF(243,"\nexport class CatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(244,"p"),e.EFF(245,"With this in place, we can define a "),e.j41(246,"code"),e.EFF(247,"PaginatedDto<CatDto>"),e.k0s(),e.EFF(248," response, as follows:"),e.k0s(),e.j41(249,"pre")(250,"code",16),e.EFF(251,"\n@ApiOkResponse({\n  schema: {\n    allOf: [\n      { $ref: getSchemaPath(PaginatedDto) },\n      {\n        properties: {\n          results: {\n            type: 'array',\n            items: { $ref: getSchemaPath(CatDto) },\n          },\n        },\n      },\n    ],\n  },\n})\nasync findAll(): Promise<PaginatedDto<CatDto>> {}\n"),e.k0s()(),e.j41(252,"p"),e.EFF(253,"In this example, we specify that the response will have allOf "),e.j41(254,"code"),e.EFF(255,"PaginatedDto"),e.k0s(),e.EFF(256," and the "),e.j41(257,"code"),e.EFF(258,"results"),e.k0s(),e.EFF(259," property will be of type "),e.j41(260,"code"),e.EFF(261,"Array<CatDto>"),e.k0s(),e.EFF(262,"."),e.k0s(),e.j41(263,"ul")(264,"li")(265,"code"),e.EFF(266,"getSchemaPath()"),e.k0s(),e.EFF(267," function that returns the OpenAPI Schema path from within the OpenAPI Spec File for a given model."),e.k0s(),e.j41(268,"li")(269,"code"),e.EFF(270,"allOf"),e.k0s(),e.EFF(271," is a concept that OAS 3 provides to cover various Inheritance related use-cases."),e.k0s()(),e.j41(272,"p"),e.EFF(273,"Lastly, since "),e.j41(274,"code"),e.EFF(275,"PaginatedDto"),e.k0s(),e.EFF(276," is not directly referenced by any controller, the "),e.j41(277,"code"),e.EFF(278,"SwaggerModule"),e.k0s(),e.EFF(279," will not be able to generate a corresponding model definition just yet. In this case, we must add it as an "),e.j41(280,"a",17),e.EFF(281,"Extra Model"),e.k0s(),e.EFF(282,". For example, we can use the "),e.j41(283,"code"),e.EFF(284,"@ApiExtraModels()"),e.k0s(),e.EFF(285," decorator on the controller level, as follows:"),e.k0s(),e.j41(286,"pre")(287,"code",16),e.EFF(288,"\n@Controller('cats')\n@ApiExtraModels(PaginatedDto)\nexport class CatsController {}\n"),e.k0s()(),e.j41(289,"p"),e.EFF(290,"If you run Swagger now, the generated "),e.j41(291,"code"),e.EFF(292,"swagger.json"),e.k0s(),e.EFF(293," for this specific endpoint should have the following response defined:"),e.k0s(),e.j41(294,"pre")(295,"code",18),e.EFF(296,'\n"responses": {\n  "200": {\n    "description": "",\n    "content": {\n      "application/json": {\n        "schema": {\n          "allOf": [\n            {\n              "$ref": "#/components/schemas/PaginatedDto"\n            },\n            {\n              "properties": {\n                "results": {\n                  "$ref": "#/components/schemas/CatDto"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n'),e.k0s()(),e.j41(297,"p"),e.EFF(298,"To make it reusable, we can create a custom decorator for "),e.j41(299,"code"),e.EFF(300,"PaginatedDto"),e.k0s(),e.EFF(301,", as follows:"),e.k0s(),e.j41(302,"pre")(303,"code",16),e.EFF(304,"\nexport const ApiPaginatedResponse = <TModel extends Type<any>>(\n  model: TModel,\n) => {\n  return applyDecorators(\n    ApiExtraModels(PaginatedDto, model),\n    ApiOkResponse({\n      schema: {\n        allOf: [\n          { $ref: getSchemaPath(PaginatedDto) },\n          {\n            properties: {\n              results: {\n                type: 'array',\n                items: { $ref: getSchemaPath(model) },\n              },\n            },\n          },\n        ],\n      },\n    }),\n  );\n};\n"),e.k0s()(),e.j41(305,"blockquote",19)(306,"strong"),e.EFF(307,"Hint"),e.k0s(),e.j41(308,"code"),e.EFF(309,"Type<any>"),e.k0s(),e.EFF(310," interface and "),e.j41(311,"code"),e.EFF(312,"applyDecorators"),e.k0s(),e.EFF(313," function are imported from the "),e.j41(314,"code"),e.EFF(315,"@nestjs/common"),e.k0s(),e.EFF(316," package.\n"),e.k0s(),e.j41(317,"p"),e.EFF(318,"To ensure that "),e.j41(319,"code"),e.EFF(320,"SwaggerModule"),e.k0s(),e.EFF(321," will generate a definition for our model, we must add it as an extra model, like we did earlier with the "),e.j41(322,"code"),e.EFF(323,"PaginatedDto"),e.k0s(),e.EFF(324," in the controller."),e.k0s(),e.j41(325,"p"),e.EFF(326,"With this in place, we can use the custom "),e.j41(327,"code"),e.EFF(328,"@ApiPaginatedResponse()"),e.k0s(),e.EFF(329," decorator on our endpoint:"),e.k0s(),e.j41(330,"pre")(331,"code",16),e.EFF(332,"\n@ApiPaginatedResponse(CatDto)\nasync findAll(): Promise<PaginatedDto<CatDto>> {}\n"),e.k0s()(),e.j41(333,"p"),e.EFF(334,"For client generation tools, this approach poses an ambiguity in how the "),e.j41(335,"code"),e.EFF(336,"PaginatedResponse<TModel>"),e.k0s(),e.EFF(337," is being generated for the client. The following snippet is an example of a client generator result for the above "),e.j41(338,"code"),e.EFF(339,"GET /"),e.k0s(),e.EFF(340," endpoint."),e.k0s(),e.j41(341,"pre")(342,"code",7),e.EFF(343,"\n// Angular\nfindAll(): Observable<{ total: number, limit: number, offset: number, results: CatDto[] }>\n"),e.k0s()(),e.j41(344,"p"),e.EFF(345,"As you can see, the "),e.j41(346,"strong"),e.EFF(347,"Return Type"),e.k0s(),e.EFF(348," here is ambiguous. To workaround this issue, you can add a "),e.j41(349,"code"),e.EFF(350,"title"),e.k0s(),e.EFF(351," property to the "),e.j41(352,"code"),e.EFF(353,"schema"),e.k0s(),e.EFF(354," for "),e.j41(355,"code"),e.EFF(356,"ApiPaginatedResponse"),e.k0s(),e.EFF(357,":"),e.k0s(),e.j41(358,"pre")(359,"code",7),e.EFF(360,"\nexport const ApiPaginatedResponse = <TModel extends Type<any>>(model: TModel) => {\n  return applyDecorators(\n    ApiOkResponse({\n      schema: {\n        title: `PaginatedResponseOf${model.name}`,\n        allOf: [\n          // ...\n        ],\n      },\n    }),\n  );\n};\n"),e.k0s()(),e.j41(361,"p"),e.EFF(362,"Now the result of the client generator tool will become:"),e.k0s(),e.j41(363,"pre")(364,"code",16),e.EFF(365,"\n// Angular\nfindAll(): Observable<PaginatedResponseOfCatDto>\n"),e.k0s()()())},dependencies:[i.a,F.Wk],encapsulation:2,changeDetection:0})}return t})(),y=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-openapi-other-features"]],features:[e.Vt3],decls:80,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/other-features.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","other-features"],["appAnchor","","id","global-prefix"],[1,"language-typescript"],["appAnchor","","id","global-parameters"],["appAnchor","","id","multiple-specifications"],[1,"language-bash"],["src","/assets/swagger-cats.png"],["src","/assets/swagger-dogs.png"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Other features"),e.k0s(),e.j41(7,"p"),e.EFF(8,"This page lists all the other available features that you may find useful."),e.k0s(),e.j41(9,"h4",6)(10,"span"),e.EFF(11,"Global prefix"),e.k0s()(),e.j41(12,"p"),e.EFF(13,"To ignore a global prefix for routes set through "),e.j41(14,"code"),e.EFF(15,"setGlobalPrefix()"),e.k0s(),e.EFF(16,", use "),e.j41(17,"code"),e.EFF(18,"ignoreGlobalPrefix"),e.k0s(),e.EFF(19,":"),e.k0s(),e.j41(20,"pre")(21,"code",7),e.EFF(22,"\nconst document = SwaggerModule.createDocument(app, options, {\n  ignoreGlobalPrefix: true,\n});\n"),e.k0s()(),e.j41(23,"h4",8)(24,"span"),e.EFF(25,"Global parameters"),e.k0s()(),e.j41(26,"p"),e.EFF(27,"You can add parameter definitions to all routes using "),e.j41(28,"code"),e.EFF(29,"DocumentBuilder"),e.k0s(),e.EFF(30,":"),e.k0s(),e.j41(31,"pre")(32,"code",7),e.EFF(33,"\nconst options = new DocumentBuilder().addGlobalParameters({\n  name: 'tenantId',\n  in: 'header',\n});\n"),e.k0s()(),e.j41(34,"h4",9)(35,"span"),e.EFF(36,"Multiple specifications"),e.k0s()(),e.j41(37,"p"),e.EFF(38,"The "),e.j41(39,"code"),e.EFF(40,"SwaggerModule"),e.k0s(),e.EFF(41," provides a way to support multiple specifications. In other words, you can serve different documentation, with different UIs, on different endpoints."),e.k0s(),e.j41(42,"p"),e.EFF(43,"To support multiple specifications, your application must be written with a modular approach. The "),e.j41(44,"code"),e.EFF(45,"createDocument()"),e.k0s(),e.EFF(46," method takes a 3rd argument, "),e.j41(47,"code"),e.EFF(48,"extraOptions"),e.k0s(),e.EFF(49,", which is an object with a property named "),e.j41(50,"code"),e.EFF(51,"include"),e.k0s(),e.EFF(52,". The "),e.j41(53,"code"),e.EFF(54,"include"),e.k0s(),e.EFF(55," property takes a value which is an array of modules."),e.k0s(),e.j41(56,"p"),e.EFF(57,"You can setup multiple specifications support as shown below:"),e.k0s(),e.j41(58,"pre")(59,"code",7),e.EFF(60,"\nimport { NestFactory } from '@nestjs/core';\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nimport { AppModule } from './app.module';\nimport { CatsModule } from './cats/cats.module';\nimport { DogsModule } from './dogs/dogs.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n\n  /**\n   * createDocument(application, configurationOptions, extraOptions);\n   *\n   * createDocument method takes an optional 3rd argument \"extraOptions\"\n   * which is an object with \"include\" property where you can pass an Array\n   * of Modules that you want to include in that Swagger Specification\n   * E.g: CatsModule and DogsModule will have two separate Swagger Specifications which\n   * will be exposed on two different SwaggerUI with two different endpoints.\n   */\n\n  const options = new DocumentBuilder()\n    .setTitle('Cats example')\n    .setDescription('The cats API description')\n    .setVersion('1.0')\n    .addTag('cats')\n    .build();\n\n  const catDocument = SwaggerModule.createDocument(app, options, {\n    include: [CatsModule],\n  });\n  SwaggerModule.setup('api/cats', app, catDocument);\n\n  const secondOptions = new DocumentBuilder()\n    .setTitle('Dogs example')\n    .setDescription('The dogs API description')\n    .setVersion('1.0')\n    .addTag('dogs')\n    .build();\n\n  const dogDocument = SwaggerModule.createDocument(app, secondOptions, {\n    include: [DogsModule],\n  });\n  SwaggerModule.setup('api/dogs', app, dogDocument);\n\n  await app.listen(process.env.PORT ?? 3000);\n}\nbootstrap();\n"),e.k0s()(),e.j41(61,"p"),e.EFF(62,"Now you can start your server with the following command:"),e.k0s(),e.j41(63,"pre")(64,"code",10),e.EFF(65,"\n$ npm run start\n"),e.k0s()(),e.j41(66,"p"),e.EFF(67,"Navigate to "),e.j41(68,"code"),e.EFF(69,"http://localhost:3000/api/cats"),e.k0s(),e.EFF(70," to see the Swagger UI for cats:"),e.k0s(),e.j41(71,"figure"),e.nrm(72,"img",11),e.k0s(),e.j41(73,"p"),e.EFF(74,"In turn, "),e.j41(75,"code"),e.EFF(76,"http://localhost:3000/api/dogs"),e.k0s(),e.EFF(77," will expose the Swagger UI for dogs:"),e.k0s(),e.j41(78,"figure"),e.nrm(79,"img",12),e.k0s()())},dependencies:[i.a],encapsulation:2,changeDetection:0})}return t})(),w=(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-openapi-security"]],features:[e.Vt3],decls:107,vars:0,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/security.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","security"],[1,"language-typescript"],["appAnchor","","id","basic-authentication"],["appAnchor","","id","bearer-authentication"],["appAnchor","","id","oauth2-authentication"],["appAnchor","","id","cookie-authentication"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Security"),e.k0s(),e.j41(7,"p"),e.EFF(8,"To define which security mechanisms should be used for a specific operation, use the "),e.j41(9,"code"),e.EFF(10,"@ApiSecurity()"),e.k0s(),e.EFF(11," decorator."),e.k0s(),e.j41(12,"pre")(13,"code",6),e.EFF(14,"\n@ApiSecurity('basic')\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(15,"p"),e.EFF(16,"Before you run your application, remember to add the security definition to your base document using "),e.j41(17,"code"),e.EFF(18,"DocumentBuilder"),e.k0s(),e.EFF(19,":"),e.k0s(),e.j41(20,"pre")(21,"code",6),e.EFF(22,"\nconst options = new DocumentBuilder().addSecurity('basic', {\n  type: 'http',\n  scheme: 'basic',\n});\n"),e.k0s()(),e.j41(23,"p"),e.EFF(24,"Some of the most popular authentication techniques are built-in (e.g., "),e.j41(25,"code"),e.EFF(26,"basic"),e.k0s(),e.EFF(27," and "),e.j41(28,"code"),e.EFF(29,"bearer"),e.k0s(),e.EFF(30,") and therefore you don't have to define security mechanisms manually as shown above."),e.k0s(),e.j41(31,"h4",7)(32,"span"),e.EFF(33,"Basic authentication"),e.k0s()(),e.j41(34,"p"),e.EFF(35,"To enable basic authentication, use "),e.j41(36,"code"),e.EFF(37,"@ApiBasicAuth()"),e.k0s(),e.EFF(38,"."),e.k0s(),e.j41(39,"pre")(40,"code",6),e.EFF(41,"\n@ApiBasicAuth()\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(42,"p"),e.EFF(43,"Before you run your application, remember to add the security definition to your base document using "),e.j41(44,"code"),e.EFF(45,"DocumentBuilder"),e.k0s(),e.EFF(46,":"),e.k0s(),e.j41(47,"pre")(48,"code",6),e.EFF(49,"\nconst options = new DocumentBuilder().addBasicAuth();\n"),e.k0s()(),e.j41(50,"h4",8)(51,"span"),e.EFF(52,"Bearer authentication"),e.k0s()(),e.j41(53,"p"),e.EFF(54,"To enable bearer authentication, use "),e.j41(55,"code"),e.EFF(56,"@ApiBearerAuth()"),e.k0s(),e.EFF(57,"."),e.k0s(),e.j41(58,"pre")(59,"code",6),e.EFF(60,"\n@ApiBearerAuth()\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(61,"p"),e.EFF(62,"Before you run your application, remember to add the security definition to your base document using "),e.j41(63,"code"),e.EFF(64,"DocumentBuilder"),e.k0s(),e.EFF(65,":"),e.k0s(),e.j41(66,"pre")(67,"code",6),e.EFF(68,"\nconst options = new DocumentBuilder().addBearerAuth();\n"),e.k0s()(),e.j41(69,"h4",9)(70,"span"),e.EFF(71,"OAuth2 authentication"),e.k0s()(),e.j41(72,"p"),e.EFF(73,"To enable OAuth2, use "),e.j41(74,"code"),e.EFF(75,"@ApiOAuth2()"),e.k0s(),e.EFF(76,"."),e.k0s(),e.j41(77,"pre")(78,"code",6),e.EFF(79,"\n@ApiOAuth2(['pets:write'])\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(80,"p"),e.EFF(81,"Before you run your application, remember to add the security definition to your base document using "),e.j41(82,"code"),e.EFF(83,"DocumentBuilder"),e.k0s(),e.EFF(84,":"),e.k0s(),e.j41(85,"pre")(86,"code",6),e.EFF(87,"\nconst options = new DocumentBuilder().addOAuth2();\n"),e.k0s()(),e.j41(88,"h4",10)(89,"span"),e.EFF(90,"Cookie authentication"),e.k0s()(),e.j41(91,"p"),e.EFF(92,"To enable cookie authentication, use "),e.j41(93,"code"),e.EFF(94,"@ApiCookieAuth()"),e.k0s(),e.EFF(95,"."),e.k0s(),e.j41(96,"pre")(97,"code",6),e.EFF(98,"\n@ApiCookieAuth()\n@Controller('cats')\nexport class CatsController {}\n"),e.k0s()(),e.j41(99,"p"),e.EFF(100,"Before you run your application, remember to add the security definition to your base document using "),e.j41(101,"code"),e.EFF(102,"DocumentBuilder"),e.k0s(),e.EFF(103,":"),e.k0s(),e.j41(104,"pre")(105,"code",6),e.EFF(106,"\nconst options = new DocumentBuilder().addCookieAuth('optional-session-id');\n"),e.k0s()()())},encapsulation:2,changeDetection:0})}return t})();var b=a(8149);const A=[{path:"introduction",component:m,data:{title:"OpenAPI (Swagger)"}},{path:"types-and-parameters",component:(()=>{class t extends r.y{static \u0275fac=(()=>{let o;return function(s){return(o||(o=e.xGo(t)))(s||t)}})();static \u0275cmp=e.VBU({type:t,selectors:[["app-openapi-types-parameters"]],features:[e.Vt3],decls:395,vars:1,consts:[["contentReference",""],[1,"content"],[1,"github-links"],["href","https://github.com/nestjs/docs.nestjs.com/edit/master/content/openapi/types-and-parameters.md","aria-label","Suggest Edits","title","Suggest Edits"],[1,"fas","fa-edit"],["id","types-and-parameters"],[1,"language-typescript"],[1,"info"],["src","/assets/swagger-dto.png"],["routerLink","/openapi/cli-plugin"],["src","/assets/swagger-dto2.png"],["rel","nofollow","target","_blank","href","https://swagger.io/specification/#schemaObject"],["appAnchor","","id","arrays"],["appAnchor","","id","circular-dependencies"],["appAnchor","","id","generics-and-interfaces"],["appAnchor","","id","enums"],["src","/assets/enum_query.gif"],["src","/assets/enum_query_array.gif"],["appAnchor","","id","enums-schema"],["rel","nofollow","target","_blank","href","https://swagger.io/docs/specification/data-models/enums/"],[1,"language-yaml"],["rel","nofollow","target","_blank","href","https://github.com/RicoSuter/NSwag"],["appAnchor","","id","raw-definitions"],["appAnchor","","id","extra-models"],["appAnchor","","id","oneof-anyof-allof"],["rel","nofollow","target","_blank","href","https://swagger.io/docs/specification/data-models/oneof-anyof-allof-not/"]],template:function(n,s){1&n&&(e.j41(0,"div",1,0)(2,"div",2)(3,"a",3),e.nrm(4,"i",4),e.k0s()(),e.j41(5,"h3",5),e.EFF(6,"Types and parameters"),e.k0s(),e.j41(7,"p"),e.EFF(8,"The "),e.j41(9,"code"),e.EFF(10,"SwaggerModule"),e.k0s(),e.EFF(11," searches for all "),e.j41(12,"code"),e.EFF(13,"@Body()"),e.k0s(),e.EFF(14,", "),e.j41(15,"code"),e.EFF(16,"@Query()"),e.k0s(),e.EFF(17,", and "),e.j41(18,"code"),e.EFF(19,"@Param()"),e.k0s(),e.EFF(20," decorators in route handlers to generate the API document. It also creates corresponding model definitions by taking advantage of reflection. Consider the following code:"),e.k0s(),e.j41(21,"pre")(22,"code",6),e.EFF(23,"\n@Post()\nasync create(@Body() createCatDto: CreateCatDto) {\n  this.catsService.create(createCatDto);\n}\n"),e.k0s()(),e.j41(24,"blockquote",7)(25,"strong"),e.EFF(26,"Hint"),e.k0s(),e.EFF(27," To explicitly set the body definition use the "),e.j41(28,"code"),e.EFF(29,"@ApiBody()"),e.k0s(),e.EFF(30," decorator (imported from the "),e.j41(31,"code"),e.EFF(32,"@nestjs/swagger"),e.k0s(),e.EFF(33," package).\n"),e.k0s(),e.j41(34,"p"),e.EFF(35,"Based on the "),e.j41(36,"code"),e.EFF(37,"CreateCatDto"),e.k0s(),e.EFF(38,", the following model definition Swagger UI will be created:"),e.k0s(),e.j41(39,"figure"),e.nrm(40,"img",8),e.k0s(),e.j41(41,"p"),e.EFF(42,"As you can see, the definition is empty although the class has a few declared properties. In order to make the class properties visible to the "),e.j41(43,"code"),e.EFF(44,"SwaggerModule"),e.k0s(),e.EFF(45,", we have to either annotate them with the "),e.j41(46,"code"),e.EFF(47,"@ApiProperty()"),e.k0s(),e.EFF(48," decorator or use the CLI plugin (read more in the "),e.j41(49,"strong"),e.EFF(50,"Plugin"),e.k0s(),e.EFF(51," section) which will do it automatically:"),e.k0s(),e.j41(52,"pre")(53,"code",6),e.EFF(54,"\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateCatDto {\n  @ApiProperty()\n  name: string;\n\n  @ApiProperty()\n  age: number;\n\n  @ApiProperty()\n  breed: string;\n}\n"),e.k0s()(),e.j41(55,"blockquote",7)(56,"strong"),e.EFF(57,"Hint"),e.k0s(),e.EFF(58," Instead of manually annotating each property, consider using the Swagger plugin (see "),e.j41(59,"a",9),e.EFF(60,"Plugin"),e.k0s(),e.EFF(61," section) which will automatically provide this for you.\n"),e.k0s(),e.j41(62,"p"),e.EFF(63,"Let's open the browser and verify the generated "),e.j41(64,"code"),e.EFF(65,"CreateCatDto"),e.k0s(),e.EFF(66," model:"),e.k0s(),e.j41(67,"figure"),e.nrm(68,"img",10),e.k0s(),e.j41(69,"p"),e.EFF(70,"In addition, the "),e.j41(71,"code"),e.EFF(72,"@ApiProperty()"),e.k0s(),e.EFF(73," decorator allows setting various "),e.j41(74,"a",11),e.EFF(75,"Schema Object"),e.k0s(),e.EFF(76," properties:"),e.k0s(),e.j41(77,"pre")(78,"code",6),e.EFF(79,"\n@ApiProperty({\n  description: 'The age of a cat',\n  minimum: 1,\n  default: 1,\n})\nage: number;\n"),e.k0s()(),e.j41(80,"blockquote",7)(81,"strong"),e.EFF(82,"Hint"),e.k0s(),e.EFF(83," Instead of explicitly typing the "),e.j41(84,"code"),e.EFF(85),e.k0s(),e.EFF(86," you can use the "),e.j41(87,"code"),e.EFF(88,"@ApiPropertyOptional()"),e.k0s(),e.EFF(89," short-hand decorator.\n"),e.k0s(),e.j41(90,"p"),e.EFF(91,"In order to explicitly set the type of the property, use the "),e.j41(92,"code"),e.EFF(93,"type"),e.k0s(),e.EFF(94," key:"),e.k0s(),e.j41(95,"pre")(96,"code",6),e.EFF(97,"\n@ApiProperty({\n  type: Number,\n})\nage: number;\n"),e.k0s()(),e.j41(98,"h4",12)(99,"span"),e.EFF(100,"Arrays"),e.k0s()(),e.j41(101,"p"),e.EFF(102,"When the property is an array, we must manually indicate the array type as shown below:"),e.k0s(),e.j41(103,"pre")(104,"code",6),e.EFF(105,"\n@ApiProperty({ type: [String] })\nnames: string[];\n"),e.k0s()(),e.j41(106,"blockquote",7)(107,"strong"),e.EFF(108,"Hint"),e.k0s(),e.EFF(109," Consider using the Swagger plugin (see "),e.j41(110,"a",9),e.EFF(111,"Plugin"),e.k0s(),e.EFF(112," section) which will automatically detect arrays.\n"),e.k0s(),e.j41(113,"p"),e.EFF(114,"Either include the type as the first element of an array (as shown above) or set the "),e.j41(115,"code"),e.EFF(116,"isArray"),e.k0s(),e.EFF(117," property to "),e.j41(118,"code"),e.EFF(119,"true"),e.k0s(),e.EFF(120,"."),e.k0s(),e.j41(121,"p"),e.nrm(122,"app-banner-enterprise"),e.k0s(),e.j41(123,"h4",13)(124,"span"),e.EFF(125,"Circular dependencies"),e.k0s()(),e.j41(126,"p"),e.EFF(127,"When you have circular dependencies between classes, use a lazy function to provide the "),e.j41(128,"code"),e.EFF(129,"SwaggerModule"),e.k0s(),e.EFF(130," with type information:"),e.k0s(),e.j41(131,"pre")(132,"code",6),e.EFF(133,"\n@ApiProperty({ type: () => Node })\nnode: Node;\n"),e.k0s()(),e.j41(134,"blockquote",7)(135,"strong"),e.EFF(136,"Hint"),e.k0s(),e.EFF(137," Consider using the Swagger plugin (see "),e.j41(138,"a",9),e.EFF(139,"Plugin"),e.k0s(),e.EFF(140," section) which will automatically detect circular dependencies.\n"),e.k0s(),e.j41(141,"h4",14)(142,"span"),e.EFF(143,"Generics and interfaces"),e.k0s()(),e.j41(144,"p"),e.EFF(145,"Since TypeScript does not store metadata about generics or interfaces, when you use them in your DTOs, "),e.j41(146,"code"),e.EFF(147,"SwaggerModule"),e.k0s(),e.EFF(148," may not be able to properly generate model definitions at runtime. For instance, the following code won't be correctly inspected by the Swagger module:"),e.k0s(),e.j41(149,"pre")(150,"code",6),e.EFF(151,"\ncreateBulk(@Body() usersDto: CreateUserDto[])\n"),e.k0s()(),e.j41(152,"p"),e.EFF(153,"In order to overcome this limitation, you can set the type explicitly:"),e.k0s(),e.j41(154,"pre")(155,"code",6),e.EFF(156,"\n@ApiBody({ type: [CreateUserDto] })\ncreateBulk(@Body() usersDto: CreateUserDto[])\n"),e.k0s()(),e.j41(157,"h4",15)(158,"span"),e.EFF(159,"Enums"),e.k0s()(),e.j41(160,"p"),e.EFF(161,"To identify an "),e.j41(162,"code"),e.EFF(163,"enum"),e.k0s(),e.EFF(164,", we must manually set the "),e.j41(165,"code"),e.EFF(166,"enum"),e.k0s(),e.EFF(167," property on the "),e.j41(168,"code"),e.EFF(169,"@ApiProperty"),e.k0s(),e.EFF(170," with an array of values."),e.k0s(),e.j41(171,"pre")(172,"code",6),e.EFF(173,"\n@ApiProperty({ enum: ['Admin', 'Moderator', 'User']})\nrole: UserRole;\n"),e.k0s()(),e.j41(174,"p"),e.EFF(175,"Alternatively, define an actual TypeScript enum as follows:"),e.k0s(),e.j41(176,"pre")(177,"code",6),e.EFF(178,"\nexport enum UserRole {\n  Admin = 'Admin',\n  Moderator = 'Moderator',\n  User = 'User',\n}\n"),e.k0s()(),e.j41(179,"p"),e.EFF(180,"You can then use the enum directly with the "),e.j41(181,"code"),e.EFF(182,"@Query()"),e.k0s(),e.EFF(183," parameter decorator in combination with the "),e.j41(184,"code"),e.EFF(185,"@ApiQuery()"),e.k0s(),e.EFF(186," decorator."),e.k0s(),e.j41(187,"pre")(188,"code",6),e.EFF(189,"\n@ApiQuery({ name: 'role', enum: UserRole })\nasync filterByRole(@Query('role') role: UserRole = UserRole.User) {}\n"),e.k0s()(),e.j41(190,"figure"),e.nrm(191,"img",16),e.k0s(),e.j41(192,"p"),e.EFF(193,"With "),e.j41(194,"code"),e.EFF(195,"isArray"),e.k0s(),e.EFF(196," set to "),e.j41(197,"strong"),e.EFF(198,"true"),e.k0s(),e.EFF(199,", the "),e.j41(200,"code"),e.EFF(201,"enum"),e.k0s(),e.EFF(202," can be selected as a "),e.j41(203,"strong"),e.EFF(204,"multi-select"),e.k0s(),e.EFF(205,":"),e.k0s(),e.j41(206,"figure"),e.nrm(207,"img",17),e.k0s(),e.j41(208,"h4",18)(209,"span"),e.EFF(210,"Enums schema"),e.k0s()(),e.j41(211,"p"),e.EFF(212,"By default, the "),e.j41(213,"code"),e.EFF(214,"enum"),e.k0s(),e.EFF(215," property will add a raw definition of "),e.j41(216,"a",19),e.EFF(217,"Enum"),e.k0s(),e.EFF(218," on the "),e.j41(219,"code"),e.EFF(220,"parameter"),e.k0s(),e.EFF(221,"."),e.k0s(),e.j41(222,"pre")(223,"code",20),e.EFF(224,"\n- breed:\n    type: 'string'\n    enum:\n      - Persian\n      - Tabby\n      - Siamese\n"),e.k0s()(),e.j41(225,"p"),e.EFF(226,"The above specification works fine for most cases. However, if you are utilizing a tool that takes the specification as "),e.j41(227,"strong"),e.EFF(228,"input"),e.k0s(),e.EFF(229," and generates "),e.j41(230,"strong"),e.EFF(231,"client-side"),e.k0s(),e.EFF(232," code, you might run into a problem with the generated code containing duplicated "),e.j41(233,"code"),e.EFF(234,"enums"),e.k0s(),e.EFF(235,". Consider the following code snippet:"),e.k0s(),e.j41(236,"pre")(237,"code",6),e.EFF(238,"\n// generated client-side code\nexport class CatDetail {\n  breed: CatDetailEnum;\n}\n\nexport class CatInformation {\n  breed: CatInformationEnum;\n}\n\nexport enum CatDetailEnum {\n  Persian = 'Persian',\n  Tabby = 'Tabby',\n  Siamese = 'Siamese',\n}\n\nexport enum CatInformationEnum {\n  Persian = 'Persian',\n  Tabby = 'Tabby',\n  Siamese = 'Siamese',\n}\n"),e.k0s()(),e.j41(239,"blockquote",7)(240,"strong"),e.EFF(241,"Hint"),e.k0s(),e.EFF(242," The above snippet is generated using a tool called "),e.j41(243,"a",21),e.EFF(244,"NSwag"),e.k0s(),e.EFF(245,".\n"),e.k0s(),e.j41(246,"p"),e.EFF(247,"You can see that now you have two "),e.j41(248,"code"),e.EFF(249,"enums"),e.k0s(),e.EFF(250," that are exactly the same.\nTo address this issue, you can pass an "),e.j41(251,"code"),e.EFF(252,"enumName"),e.k0s(),e.EFF(253," along with the "),e.j41(254,"code"),e.EFF(255,"enum"),e.k0s(),e.EFF(256," property in your decorator."),e.k0s(),e.j41(257,"pre")(258,"code",6),e.EFF(259,"\nexport class CatDetail {\n  @ApiProperty({ enum: CatBreed, enumName: 'CatBreed' })\n  breed: CatBreed;\n}\n"),e.k0s()(),e.j41(260,"p"),e.EFF(261,"The "),e.j41(262,"code"),e.EFF(263,"enumName"),e.k0s(),e.EFF(264," property enables "),e.j41(265,"code"),e.EFF(266,"@nestjs/swagger"),e.k0s(),e.EFF(267," to turn "),e.j41(268,"code"),e.EFF(269,"CatBreed"),e.k0s(),e.EFF(270," into its own "),e.j41(271,"code"),e.EFF(272,"schema"),e.k0s(),e.EFF(273," which in turns makes "),e.j41(274,"code"),e.EFF(275,"CatBreed"),e.k0s(),e.EFF(276," enum reusable. The specification will look like the following:"),e.k0s(),e.j41(277,"pre")(278,"code",20),e.EFF(279,"\nCatDetail:\n  type: 'object'\n  properties:\n    ...\n    - breed:\n        schema:\n          $ref: '#/components/schemas/CatBreed'\nCatBreed:\n  type: string\n  enum:\n    - Persian\n    - Tabby\n    - Siamese\n"),e.k0s()(),e.j41(280,"blockquote",7)(281,"strong"),e.EFF(282,"Hint"),e.k0s(),e.EFF(283," Any "),e.j41(284,"strong"),e.EFF(285,"decorator"),e.k0s(),e.EFF(286," that takes "),e.j41(287,"code"),e.EFF(288,"enum"),e.k0s(),e.EFF(289," as a property will also take "),e.j41(290,"code"),e.EFF(291,"enumName"),e.k0s(),e.EFF(292,".\n"),e.k0s(),e.j41(293,"h4",22)(294,"span"),e.EFF(295,"Raw definitions"),e.k0s()(),e.j41(296,"p"),e.EFF(297,"In some specific scenarios (e.g., deeply nested arrays, matrices), you may want to describe your type by hand."),e.k0s(),e.j41(298,"pre")(299,"code",6),e.EFF(300,"\n@ApiProperty({\n  type: 'array',\n  items: {\n    type: 'array',\n    items: {\n      type: 'number',\n    },\n  },\n})\ncoords: number[][];\n"),e.k0s()(),e.j41(301,"p"),e.EFF(302,"Likewise, in order to define your input/output content manually in controller classes, use the "),e.j41(303,"code"),e.EFF(304,"schema"),e.k0s(),e.EFF(305," property:"),e.k0s(),e.j41(306,"pre")(307,"code",6),e.EFF(308,"\n@ApiBody({\n  schema: {\n    type: 'array',\n    items: {\n      type: 'array',\n      items: {\n        type: 'number',\n      },\n    },\n  },\n})\nasync create(@Body() coords: number[][]) {}\n"),e.k0s()(),e.j41(309,"h4",23)(310,"span"),e.EFF(311,"Extra models"),e.k0s()(),e.j41(312,"p"),e.EFF(313,"To define additional models that are not directly referenced in your controllers but should be inspected by the Swagger module, use the "),e.j41(314,"code"),e.EFF(315,"@ApiExtraModels()"),e.k0s(),e.EFF(316," decorator:"),e.k0s(),e.j41(317,"pre")(318,"code",6),e.EFF(319,"\n@ApiExtraModels(ExtraModel)\nexport class CreateCatDto {}\n"),e.k0s()(),e.j41(320,"blockquote",7)(321,"strong"),e.EFF(322,"Hint"),e.k0s(),e.EFF(323," You only need to use "),e.j41(324,"code"),e.EFF(325,"@ApiExtraModels()"),e.k0s(),e.EFF(326," once for a specific model class.\n"),e.k0s(),e.j41(327,"p"),e.EFF(328,"Alternatively, you can pass an options object with the "),e.j41(329,"code"),e.EFF(330,"extraModels"),e.k0s(),e.EFF(331," property specified to the "),e.j41(332,"code"),e.EFF(333,"SwaggerModule#createDocument()"),e.k0s(),e.EFF(334," method, as follows:"),e.k0s(),e.j41(335,"pre")(336,"code",6),e.EFF(337,"\nconst document = SwaggerModule.createDocument(app, options, {\n  extraModels: [ExtraModel],\n});\n"),e.k0s()(),e.j41(338,"p"),e.EFF(339,"To get a reference ("),e.j41(340,"code"),e.EFF(341,"$ref"),e.k0s(),e.EFF(342,") to your model, use the "),e.j41(343,"code"),e.EFF(344,"getSchemaPath(ExtraModel)"),e.k0s(),e.EFF(345," function:"),e.k0s(),e.j41(346,"pre")(347,"code",6),e.EFF(348,"\n'application/vnd.api+json': {\n   schema: { $ref: getSchemaPath(ExtraModel) },\n},\n"),e.k0s()(),e.j41(349,"h4",24)(350,"span"),e.EFF(351,"oneOf, anyOf, allOf"),e.k0s()(),e.j41(352,"p"),e.EFF(353,"To combine schemas, you can use the "),e.j41(354,"code"),e.EFF(355,"oneOf"),e.k0s(),e.EFF(356,", "),e.j41(357,"code"),e.EFF(358,"anyOf"),e.k0s(),e.EFF(359," or "),e.j41(360,"code"),e.EFF(361,"allOf"),e.k0s(),e.EFF(362," keywords ("),e.j41(363,"a",25),e.EFF(364,"read more"),e.k0s(),e.EFF(365,")."),e.k0s(),e.j41(366,"pre")(367,"code",6),e.EFF(368,"\n@ApiProperty({\n  oneOf: [\n    { $ref: getSchemaPath(Cat) },\n    { $ref: getSchemaPath(Dog) },\n  ],\n})\npet: Cat | Dog;\n"),e.k0s()(),e.j41(369,"p"),e.EFF(370,"If you want to define a polymorphic array (i.e., an array whose members span multiple schemas), you should use a raw definition (see above) to define your type by hand."),e.k0s(),e.j41(371,"pre")(372,"code",6),e.EFF(373,"\ntype Pet = Cat | Dog;\n\n@ApiProperty({\n  type: 'array',\n  items: {\n    oneOf: [\n      { $ref: getSchemaPath(Cat) },\n      { $ref: getSchemaPath(Dog) },\n    ],\n  },\n})\npets: Pet[];\n"),e.k0s()(),e.j41(374,"blockquote",7)(375,"strong"),e.EFF(376,"Hint"),e.k0s(),e.EFF(377," The "),e.j41(378,"code"),e.EFF(379,"getSchemaPath()"),e.k0s(),e.EFF(380," function is imported from "),e.j41(381,"code"),e.EFF(382,"@nestjs/swagger"),e.k0s(),e.EFF(383,".\n"),e.k0s(),e.j41(384,"p"),e.EFF(385,"Both "),e.j41(386,"code"),e.EFF(387,"Cat"),e.k0s(),e.EFF(388," and "),e.j41(389,"code"),e.EFF(390,"Dog"),e.k0s(),e.EFF(391," must be defined as extra models using the "),e.j41(392,"code"),e.EFF(393,"@ApiExtraModels()"),e.k0s(),e.EFF(394," decorator (at the class-level)."),e.k0s()()),2&n&&(e.R7$(85),e.JRh("@ApiProperty({ required: false })"))},dependencies:[i.a,b.d,F.Wk],encapsulation:2,changeDetection:0})}return t})(),data:{title:"Types and Parameters - OpenAPI"}},{path:"operations",component:f,data:{title:"Operations - OpenAPI"}},{path:"security",component:w,data:{title:"Security - OpenAPI"}},{path:"decorators",component:u,data:{title:"Decorators - OpenAPI"}},{path:"mapped-types",component:g,data:{title:"Mapped Types - OpenAPI"}},{path:"cli-plugin",component:l,data:{title:"CLI Plugin - OpenAPI"}},{path:"other-features",component:y,data:{title:"Other features - OpenAPI"}},{path:"migration-guide",component:j,data:{title:"Migration guide - OpenAPI"}}];let C=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=e.$C({type:t});static \u0275inj=e.G2t({imports:[c.MD,d.G,F.iI.forChild(A)]})}return t})()}}]);